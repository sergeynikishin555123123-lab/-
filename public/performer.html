<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>üë®‚Äçüíº –ñ–µ–Ω—Å–∫–∏–π –ö–æ–Ω—Å—å–µ—Ä–∂ | –ü–∞–Ω–µ–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ, –∫–∞–∫ –≤ –≤–∞—à–µ–º —Ñ–∞–π–ª–µ */
        /* ... –≤–µ—Å—å –≤–∞—à CSS ... */
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
    <header class="performer-header">
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" onclick="navigateToSection('dashboard')">
                    <i class="fas fa-user-tie"></i>
                    –ñ–µ–Ω—Å–∫–∏–π –ö–æ–Ω—Å—å–µ—Ä–∂
                    <span style="font-size: 0.8rem; margin-left: 8px; background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px;">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</span>
                </a>
                
                <div class="performer-info">
                    <div class="flex items-center gap-3">
                        <div class="performer-avatar">
                            <span id="performerInitials">–ò</span>
                        </div>
                        <div class="performer-name" id="performerName">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</div>
                    </div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        –í—ã–π—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </header>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
        <div class="container">
            <div class="performer-layout">
                <!-- –ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
                <aside class="sidebar">
                    <h2 class="sidebar-title">–ü–∞–Ω–µ–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h2>
                    <nav class="nav-menu">
                        <a href="#" class="nav-item active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            –î–∞—à–±–æ—Ä–¥
                        </a>
                        <a href="#" class="nav-item" data-section="available-tasks">
                            <i class="fas fa-tasks"></i>
                            –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏
                            <span class="nav-badge" id="availableTasksCount">0</span>
                        </a>
                        <a href="#" class="nav-item" data-section="my-tasks">
                            <i class="fas fa-list-check"></i>
                            –ú–æ–∏ –∑–∞–¥–∞—á–∏
                            <span class="nav-badge" id="myTasksCount">0</span>
                        </a>
                        <a href="#" class="nav-item" data-section="in-progress">
                            <i class="fas fa-spinner"></i>
                            –í —Ä–∞–±–æ—Ç–µ
                        </a>
                        <a href="#" class="nav-item" data-section="completed">
                            <i class="fas fa-check-circle"></i>
                            –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ
                        </a>
                        <a href="#" class="nav-item" data-section="profile">
                            <i class="fas fa-user"></i>
                            –ü—Ä–æ—Ñ–∏–ª—å
                        </a>
                        <a href="#" class="nav-item" data-section="reviews">
                            <i class="fas fa-star"></i>
                            –û—Ç–∑—ã–≤—ã
                        </a>
                        <a href="#" class="nav-item" data-section="earnings">
                            <i class="fas fa-wallet"></i>
                            –ó–∞—Ä–∞–±–æ—Ç–æ–∫
                        </a>
                        <a href="#" class="nav-item" onclick="navigateToMainApp()">
                            <i class="fas fa-home"></i>
                            –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                        </a>
                    </nav>
                </aside>
                
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
                <div class="content" id="contentArea">
                    <!-- –î–∞—à–±–æ—Ä–¥ -->
                    <div id="dashboardSection" class="content-section active">
                        <div class="content-header">
                            <h1 class="content-title">–î–∞—à–±–æ—Ä–¥ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h1>
                            <p class="content-subtitle">–û–±–∑–æ—Ä –≤–∞—à–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</p>
                        </div>
                        
                        <!-- –ü—Ä–æ—Ñ–∏–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
                        <div class="profile-card" id="performerProfileCard">
                            <!-- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="totalEarnings">0 ‚ÇΩ</div>
                                <div class="stat-label">–û–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="earningsChange">0%</span> –∑–∞ –º–µ—Å—è—Ü
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="completedTasks">0</div>
                                <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="tasksChange">0%</span> –∑–∞ –º–µ—Å—è—Ü
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="avgRating">0.0</div>
                                <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="ratingChange">0%</span> –∑–∞ –º–µ—Å—è—Ü
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="activeTasks">0</div>
                                <div class="stat-label">–ó–∞–¥–∞—á –≤ —Ä–∞–±–æ—Ç–µ</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="activeChange">0%</span> –∑–∞ –º–µ—Å—è—Ü
                                </div>
                            </div>
                        </div>
                        
                        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                        <div class="content-header" style="margin-top: 40px;">
                            <h2 class="content-title" style="font-size: 1.5rem;">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                            <p class="content-subtitle">–ù–∞—á–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å</p>
                        </div>
                        
                        <div class="grid grid-4" style="gap: 16px; margin-bottom: 32px;">
                            <button class="btn btn-primary" onclick="navigateToSection('available-tasks')">
                                <i class="fas fa-search"></i>
                                –ù–∞–π—Ç–∏ –∑–∞–¥–∞—á–∏
                            </button>
                            <button class="btn btn-secondary" onclick="navigateToSection('my-tasks')">
                                <i class="fas fa-list"></i>
                                –ú–æ–∏ –∑–∞–¥–∞—á–∏
                            </button>
                            <button class="btn btn-success" onclick="checkMessages()">
                                <i class="fas fa-comments"></i>
                                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∞—Ç
                            </button>
                            <button class="btn btn-warning" onclick="updateAvailability()">
                                <i class="fas fa-toggle-on"></i>
                                –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
                            </button>
                        </div>
                        
                        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏ -->
                        <div class="content-header" style="margin-top: 40px;">
                            <h2 class="content-title" style="font-size: 1.5rem;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
                            <p class="content-subtitle">–ù–µ–¥–∞–≤–Ω–æ –ø—Ä–∏–Ω—è—Ç—ã–µ –∑–∞–¥–∞—á–∏</p>
                        </div>
                        
                        <div class="table-container">
                            <table id="recentTasksTable">
                                <thead>
                                    <tr>
                                        <th>–ó–∞–¥–∞—á–∞</th>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–î–µ–¥–ª–∞–π–Ω</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏ -->
                    <div id="availableTasksSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏</h1>
                            <p class="content-subtitle">–ó–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω—è—Ç—å</p>
                        </div>
                        
                        <!-- –§–∏–ª—å—Ç—Ä—ã -->
                        <div class="filters">
                            <div class="filter-group">
                                <label class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <select class="filter-select" id="categoryFilter">
                                    <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                <select class="filter-select" id="priorityFilter">
                                    <option value="all">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                                    <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                    <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                    <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">–ë—é–¥–∂–µ—Ç –æ—Ç</label>
                                <input type="number" class="filter-input" id="budgetFrom" placeholder="0">
                            </div>
                            <div class="filter-group">
                                <button class="btn btn-primary" onclick="applyFilters()">
                                    <i class="fas fa-filter"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                                </button>
                                <button class="btn btn-secondary" onclick="resetFilters()">
                                    <i class="fas fa-redo"></i> –°–±—Ä–æ—Å–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á -->
                        <div class="table-container">
                            <table id="availableTasksTable">
                                <thead>
                                    <tr>
                                        <th>–ó–∞–¥–∞—á–∞</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–ë—é–¥–∂–µ—Ç</th>
                                        <th>–î–µ–¥–ª–∞–π–Ω</th>
                                        <th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="no-messages" id="noAvailableTasks" style="display: none;">
                            <i class="fas fa-tasks"></i>
                            <p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á</p>
                            <p class="text-sm">–ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å, –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–¥—É—Ç –∑–∞–∫–∞–∑—ã</p>
                        </div>
                    </div>
                    
                    <!-- –ú–æ–∏ –∑–∞–¥–∞—á–∏ -->
                    <div id="myTasksSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–ú–æ–∏ –∑–∞–¥–∞—á–∏</h1>
                            <p class="content-subtitle">–í—Å–µ –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø—Ä–∏–Ω—è–ª–∏</p>
                        </div>
                        
                        <!-- –§–∏–ª—å—Ç—Ä—ã -->
                        <div class="filters">
                            <div class="filter-group">
                                <label class="filter-label">–°—Ç–∞—Ç—É—Å</label>
                                <select class="filter-select" id="statusFilter">
                                    <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                    <option value="assigned">–ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ</option>
                                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                                    <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">–î–∞—Ç–∞ –æ—Ç</label>
                                <input type="date" class="filter-input" id="dateFrom">
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">–î–∞—Ç–∞ –¥–æ</label>
                                <input type="date" class="filter-input" id="dateTo">
                            </div>
                            <div class="filter-group">
                                <button class="btn btn-primary" onclick="applyMyTasksFilters()">
                                    <i class="fas fa-filter"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <!-- –¢–∞–±–ª–∏—Ü–∞ –º–æ–∏—Ö –∑–∞–¥–∞—á -->
                        <div class="table-container">
                            <table id="myTasksTable">
                                <thead>
                                    <tr>
                                        <th>–ó–∞–¥–∞—á–∞</th>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–ë—é–¥–∂–µ—Ç</th>
                                        <th>–î–µ–¥–ª–∞–π–Ω</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- –ó–∞–¥–∞—á–∞ –≤ —Ä–∞–±–æ—Ç–µ (–¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä) -->
                    <div id="taskDetailSection" class="content-section">
                        <!-- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <!-- –ó–∞–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç–µ -->
                    <div id="inProgressSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–ó–∞–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç–µ</h1>
                            <p class="content-subtitle">–¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ</p>
                        </div>
                        
                        <div class="table-container">
                            <table id="inProgressTable">
                                <thead>
                                    <tr>
                                        <th>–ó–∞–¥–∞—á–∞</th>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–ë—é–¥–∂–µ—Ç</th>
                                        <th>–î–µ–¥–ª–∞–π–Ω</th>
                                        <th>–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="no-messages" id="noInProgressTasks" style="display: none;">
                            <i class="fas fa-spinner"></i>
                            <p>–ù–µ—Ç –∑–∞–¥–∞—á –≤ —Ä–∞–±–æ—Ç–µ</p>
                            <p class="text-sm">–ü—Ä–∏–º–∏—Ç–µ –∑–∞–¥–∞—á—É –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏"</p>
                        </div>
                    </div>
                    
                    <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ -->
                    <div id="completedSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏</h1>
                            <p class="content-subtitle">–ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –≤–∞–º–∏ –∑–∞–¥–∞—á</p>
                        </div>
                        
                        <!-- –§–∏–ª—å—Ç—Ä—ã -->
                        <div class="filters">
                            <div class="filter-group">
                                <label class="filter-label">–î–∞—Ç–∞ –æ—Ç</label>
                                <input type="date" class="filter-input" id="completedDateFrom">
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">–î–∞—Ç–∞ –¥–æ</label>
                                <input type="date" class="filter-input" id="completedDateTo">
                            </div>
                            <div class="filter-group">
                                <button class="btn btn-primary" onclick="loadCompletedTasks()">
                                    <i class="fas fa-filter"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table id="completedTable">
                                <thead>
                                    <tr>
                                        <th>–ó–∞–¥–∞—á–∞</th>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–ë—é–¥–∂–µ—Ç</th>
                                        <th>–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è</th>
                                        <th>–û—Ü–µ–Ω–∫–∞</th>
                                        <th>–û—Ç–∑—ã–≤</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
                    <div id="profileSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h1>
                            <p class="content-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏</p>
                        </div>
                        
                        <div class="profile-card">
                            <div class="profile-header">
                                <div class="profile-avatar-large" id="profileAvatarLarge">
                                    –ò
                                </div>
                                <div class="profile-info">
                                    <div class="profile-name" id="profileFullName">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</div>
                                    <div class="profile-rating">
                                        <div class="stars">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star-half-alt"></i>
                                        </div>
                                        <span class="rating-value" id="profileRating">4.5</span>
                                        <span class="text-medium">(24 –æ—Ç–∑—ã–≤–∞)</span>
                                    </div>
                                    <div class="text-medium" id="profileEmail">email@example.com</div>
                                    <div class="text-medium" id="profilePhone">+7 (999) 123-45-67</div>
                                    
                                    <div class="profile-categories" id="profileCategories">
                                        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="profileTotalTasks">0</div>
                                    <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="profileSuccessRate">0%</div>
                                    <div class="stat-label">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="profileAvgTime">0—á</div>
                                    <div class="stat-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="profileResponseTime">0—á</div>
                                    <div class="stat-label">–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è -->
                        <div class="content-header" style="margin-top: 40px;">
                            <h2 class="content-title" style="font-size: 1.5rem;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</h2>
                        </div>
                        
                        <div class="card" style="padding: 24px;">
                            <div class="grid grid-2" style="gap: 20px;">
                                <div>
                                    <h3 style="font-size: 1.1rem; margin-bottom: 16px;">–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                                    <div class="form-group">
                                        <label class="filter-label">–ò–º—è</label>
                                        <input type="text" class="filter-input" id="editFirstName" placeholder="–ò–º—è">
                                    </div>
                                    <div class="form-group">
                                        <label class="filter-label">–§–∞–º–∏–ª–∏—è</label>
                                        <input type="text" class="filter-input" id="editLastName" placeholder="–§–∞–º–∏–ª–∏—è">
                                    </div>
                                    <div class="form-group">
                                        <label class="filter-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                        <input type="tel" class="filter-input" id="editPhone" placeholder="+7 (999) 123-45-67">
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 style="font-size: 1.1rem; margin-bottom: 16px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–±–æ—Ç—ã</h3>
                                    <div class="form-group">
                                        <label class="filter-label">–°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏</label>
                                        <select class="filter-select" id="availabilityStatus">
                                            <option value="available">–î–æ—Å—Ç—É–ø–µ–Ω</option>
                                            <option value="busy">–ó–∞–Ω—è—Ç</option>
                                            <option value="away">–ù–µ –Ω–∞ –º–µ—Å—Ç–µ</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="filter-label">–ú–∞–∫—Å–∏–º—É–º –∑–∞–¥–∞—á –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</label>
                                        <input type="number" class="filter-input" id="maxTasks" min="1" max="10" value="3">
                                    </div>
                                    <div class="form-group">
                                        <label class="filter-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±—é–¥–∂–µ—Ç (‚ÇΩ)</label>
                                        <input type="number" class="filter-input" id="minBudget" placeholder="0">
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 32px;">
                                <h3 style="font-size: 1.1rem; margin-bottom: 16px;">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏</h3>
                                <div class="profile-categories" id="editCategories">
                                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" style="margin-top: 24px;" onclick="saveProfileSettings()">
                                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                            </button>
                        </div>
                    </div>
                    
                    <!-- –û—Ç–∑—ã–≤—ã -->
                    <div id="reviewsSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–û—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤</h1>
                            <p class="content-subtitle">–ß—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –∫–ª–∏–µ–Ω—Ç—ã –æ –≤–∞—à–µ–π —Ä–∞–±–æ—Ç–µ</p>
                        </div>
                        
                        <div class="reviews-grid" id="reviewsGrid">
                            <!-- –û—Ç–∑—ã–≤—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    
                    <!-- –ó–∞—Ä–∞–±–æ—Ç–æ–∫ -->
                    <div id="earningsSection" class="content-section">
                        <div class="content-header">
                            <h1 class="content-title">–í–∞—à –∑–∞—Ä–∞–±–æ—Ç–æ–∫</h1>
                            <p class="content-subtitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ –≤—ã–ø–ª–∞—Ç</p>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="totalEarningsAmount">0 ‚ÇΩ</div>
                                <div class="stat-label">–û–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="monthlyEarnings">0 ‚ÇΩ</div>
                                <div class="stat-label">–ó–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="weeklyEarnings">0 ‚ÇΩ</div>
                                <div class="stat-label">–ó–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="avgTaskPrice">0 ‚ÇΩ</div>
                                <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
                            </div>
                        </div>
                        
                        <div class="content-header" style="margin-top: 40px;">
                            <h2 class="content-title" style="font-size: 1.5rem;">–ò—Å—Ç–æ—Ä–∏—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞</h2>
                            <p class="content-subtitle">–ü–æ –º–µ—Å—è—Ü–∞–º</p>
                        </div>
                        
                        <div class="table-container">
                            <table id="earningsHistoryTable">
                                <thead>
                                    <tr>
                                        <th>–ú–µ—Å—è—Ü</th>
                                        <th>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á</th>
                                        <th>–û–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫</th>
                                        <th>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="no-messages" id="noEarningsData" style="display: none;">
                            <i class="fas fa-wallet"></i>
                            <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞—Ä–∞–±–æ—Ç–∫–µ</p>
                            <p class="text-sm">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Ö–æ–¥–∞—Ö –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á</p>
                        </div>
                        
                        <div class="content-header" style="margin-top: 40px;">
                            <h2 class="content-title" style="font-size: 1.5rem;">–í—ã–ø–ª–∞—Ç—ã</h2>
                            <p class="content-subtitle">–ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç –Ω–∞ –∫–∞—Ä—Ç—É</p>
                        </div>
                        
                        <div class="table-container">
                            <table id="payoutsTable">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–°—É–º–º–∞</th>
                                        <th>–°–ø–æ—Å–æ–±</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="card" style="padding: 24px; margin-top: 24px; background: linear-gradient(135deg, var(--blue-light), #D6EAF8);">
                            <h3 style="margin-bottom: 16px;">–ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É</h3>
                            <p class="text-medium" style="margin-bottom: 16px;">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞: 1 000 ‚ÇΩ</p>
                            <div class="flex gap-3">
                                <input type="number" class="filter-input" id="payoutAmount" placeholder="–°—É–º–º–∞" min="1000" style="flex: 1;">
                                <button class="btn btn-primary" onclick="requestPayout()">
                                    <i class="fas fa-credit-card"></i> –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="notification-container" id="notificationContainer"></div>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loader"></div>
        <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const app = {
            currentPerformer: null,
            token: localStorage.getItem('token'),
            currentSection: 'dashboard',
            currentTaskId: null,
            availableTasks: [],
            myTasks: [],
            performerStats: null,
            performerCategories: [],
            allCategories: [],
            
            // –§–∏–ª—å—Ç—Ä—ã
            filters: {
                category: 'all',
                priority: 'all',
                budgetFrom: null,
                status: 'all',
                dateFrom: null,
                dateTo: null
            }
        };

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–∞—Ç–∞
        let currentChatTask = null;
        let performerChatMessages = [];
        let performerChatPolling = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üëî –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            if (!app.token) {
                window.location.href = 'index.html';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await checkPerformerRole();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
            await loadPerformerData();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            setupEventListeners();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            await loadInitialData();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–¥–µ–ª
            loadCurrentSection();
            
            // –ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            startNotifications();
            
            console.log('‚úÖ –ü–∞–Ω–µ–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –≥–æ—Ç–æ–≤–∞');
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function checkPerformerRole() {
            try {
                const response = await fetch('/api/auth/check', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success && (data.data.user.role === 'performer' || 
                        data.data.user.role === 'admin' || 
                        data.data.user.role === 'superadmin' || 
                        data.data.user.role === 'manager')) {
                        app.currentPerformer = data.data.user;
                        return true;
                    }
                }
                
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                window.location.href = 'index.html';
                return false;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏:', error);
                window.location.href = 'index.html';
                return false;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
        async function loadPerformerData() {
            try {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                document.getElementById('performerName').textContent = 
                    `${app.currentPerformer.first_name} ${app.currentPerformer.last_name}`;
                document.getElementById('performerInitials').textContent = 
                    app.currentPerformer.first_name.charAt(0);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                updatePerformerProfile();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        async function loadInitialData() {
            showLoading('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                await loadPerformerStats();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                await loadAllCategories();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–¥–∞—á–∏
                await loadAvailableTasks();
                await loadMyTasks();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
                updateCounters();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
            } finally {
                hideLoading();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        async function loadAllCategories() {
            try {
                const response = await fetch('/api/categories');
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        app.allCategories = data.data.categories;
                        updateCategoryFilter();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
        async function loadPerformerStats() {
            try {
                const response = await fetch('/api/performer/stats', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        app.performerStats = data.data;
                        updateDashboardStats();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
        async function loadPerformerCategories() {
            try {
                const response = await fetch('/api/performer/categories', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        app.performerCategories = data.data.categories;
                        updatePerformerProfile();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á
        async function loadAvailableTasks() {
            try {
                const response = await fetch('/api/performer/tasks/available', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        app.availableTasks = data.data.tasks;
                        updateCounters();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–∏—Ö –∑–∞–¥–∞—á
        async function loadMyTasks() {
            try {
                const response = await fetch('/api/performer/tasks', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        app.myTasks = data.data.tasks;
                        updateCounters();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–∏—Ö –∑–∞–¥–∞—á:', error);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
        function updateCounters() {
            document.getElementById('availableTasksCount').textContent = app.availableTasks.length;
            
            // –¢–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
            const myAssignedTasks = app.myTasks.filter(task => task.performer_id === app.currentPerformer.id);
            document.getElementById('myTasksCount').textContent = myAssignedTasks.length;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞
        function updateDashboardStats() {
            if (!app.performerStats) return;
            
            const stats = app.performerStats.stats;
            
            document.getElementById('totalEarnings').textContent = 
                (stats.total_earnings || 0).toLocaleString() + ' ‚ÇΩ';
            document.getElementById('completedTasks').textContent = 
                stats.completed_tasks || 0;
            document.getElementById('avgRating').textContent = 
                (stats.avg_rating || 0).toFixed(1);
            document.getElementById('activeTasks').textContent = 
                app.performerStats.active_tasks || 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
            updatePerformerProfile();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
        function updatePerformerProfile() {
            const profileCard = document.getElementById('performerProfileCard');
            if (!profileCard || !app.performerStats) return;
            
            const stats = app.performerStats.stats;
            const categories = app.performerCategories || [];
            
            profileCard.innerHTML = `
                <div class="profile-header">
                    <div class="profile-avatar-large">
                        ${app.currentPerformer.first_name.charAt(0)}
                    </div>
                    <div class="profile-info">
                        <div class="profile-name">
                            ${app.currentPerformer.first_name} ${app.currentPerformer.last_name}
                        </div>
                        <div class="profile-rating">
                            <div class="stars">
                                ${getStarsHTML(stats.avg_rating || 0)}
                            </div>
                            <span class="rating-value">${(stats.avg_rating || 0).toFixed(1)}</span>
                            <span class="text-medium">(${app.performerStats.recent_reviews?.length || 0} –æ—Ç–∑—ã–≤–æ–≤)</span>
                        </div>
                        <div class="text-medium">${app.currentPerformer.email}</div>
                        <div class="text-medium">${app.currentPerformer.phone}</div>
                        
                        <div class="profile-categories">
                            ${categories.map(cat => `
                                <span class="category-tag">
                                    ${cat.display_name}
                                    ${cat.experience_years ? `<span class="text-xs">(${cat.experience_years} –ª–µ—Ç)</span>` : ''}
                                </span>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${stats.total_tasks || 0}</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.completed_tasks || 0}</div>
                        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${app.performerStats.active_tasks || 0}</div>
                        <div class="stat-label">–í —Ä–∞–±–æ—Ç–µ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.avg_rating ? stats.avg_rating.toFixed(1) : '0.0'}</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                    </div>
                </div>
            `;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ HTML –¥–ª—è –∑–≤–µ–∑–¥ —Ä–µ–π—Ç–∏–Ω–≥–∞
        function getStarsHTML(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 0; i < 5; i++) {
                if (i < fullStars) {
                    stars += '<i class="fas fa-star"></i>';
                } else if (i === fullStars && hasHalfStar) {
                    stars += '<i class="fas fa-star-half-alt"></i>';
                } else {
                    stars += '<i class="far fa-star"></i>';
                }
            }
            
            return stars;
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
        function navigateToSection(section) {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–ø—Ä–æ—Å —á–∞—Ç–∞ –ø—Ä–∏ —É—Ö–æ–¥–µ
            if (section !== 'chat') {
                stopPerformerChatPolling();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const targetNav = document.querySelector(`.nav-item[data-section="${section}"]`);
            if (targetNav) {
                targetNav.classList.add('active');
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
            document.querySelectorAll('.content-section').forEach(sec => {
                sec.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
            const targetSection = document.getElementById(`${section}Section`);
            if (targetSection) {
                targetSection.classList.add('active');
                app.currentSection = section;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞
                loadSectionData(section);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞
        function loadSectionData(section) {
            switch(section) {
                case 'dashboard':
                    updateDashboardStats();
                    loadRecentTasksTable();
                    break;
                case 'available-tasks':
                    loadAvailableTasksTable();
                    break;
                case 'my-tasks':
                    loadMyTasksTable();
                    break;
                case 'in-progress':
                    loadInProgressTasks();
                    break;
                case 'completed':
                    loadCompletedTasks();
                    break;
                case 'profile':
                    loadProfileData();
                    break;
                case 'reviews':
                    loadReviews();
                    break;
                case 'earnings':
                    loadEarningsData();
                    break;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
        function loadCurrentSection() {
            loadSectionData(app.currentSection);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–¥–∞—á
        function loadRecentTasksTable() {
            const container = document.getElementById('recentTasksTable').querySelector('tbody');
            if (!container) return;
            
            const recentTasks = app.myTasks
                .filter(task => task.performer_id === app.currentPerformer.id)
                .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
                .slice(0, 5);
            
            container.innerHTML = recentTasks.map(task => {
                const status = getStatusInfo(task.status);
                return `
                    <tr>
                        <td>
                            <div class="font-medium">${task.title}</div>
                            <div class="text-sm text-medium">#${task.task_number}</div>
                        </td>
                        <td>${task.client_first_name} ${task.client_last_name || ''}</td>
                        <td>${task.category_name}</td>
                        <td>
                            <span class="status-badge ${status.class}">
                                <i class="${status.icon}"></i>
                                ${status.name}
                            </span>
                        </td>
                        <td>${task.deadline ? new Date(task.deadline).toLocaleDateString('ru-RU') : '‚Äî'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-secondary btn-sm" onclick="viewTask(${task.id})">
                                    <i class="fas fa-eye"></i>
                                </button>
                                ${task.status === 'assigned' || task.status === 'in_progress' ? `
                                    <button class="btn btn-primary btn-sm" onclick="openPerformerChat(${task.id})">
                                        <i class="fas fa-comment"></i>
                                    </button>
                                ` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á
        function loadAvailableTasksTable() {
            const container = document.getElementById('availableTasksTable').querySelector('tbody');
            const noTasks = document.getElementById('noAvailableTasks');
            
            if (!container) return;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
            let filteredTasks = [...app.availableTasks];
            
            if (app.filters.category !== 'all') {
                filteredTasks = filteredTasks.filter(task => task.category_id == app.filters.category);
            }
            
            if (app.filters.priority !== 'all') {
                filteredTasks = filteredTasks.filter(task => task.priority === app.filters.priority);
            }
            
            if (app.filters.budgetFrom) {
                filteredTasks = filteredTasks.filter(task => task.price >= app.filters.budgetFrom);
            }
            
            if (filteredTasks.length === 0) {
                container.innerHTML = '';
                noTasks.style.display = 'block';
                return;
            }
            
            noTasks.style.display = 'none';
            
            container.innerHTML = filteredTasks.map(task => {
                const priorityClass = `status-${task.priority === 'urgent' ? 'new' : 
                                     task.priority === 'high' ? 'search' : 'assigned'}`;
                const priorityText = task.priority === 'urgent' ? '–°—Ä–æ—á–Ω–æ' : 
                                   task.priority === 'high' ? '–í—ã—Å–æ–∫–∏–π' : 
                                   task.priority === 'medium' ? '–°—Ä–µ–¥–Ω–∏–π' : '–ù–∏–∑–∫–∏–π';
                
                return `
                    <tr>
                        <td>
                            <div class="font-medium">${task.title}</div>
                            <div class="text-sm text-medium">${task.description.substring(0, 60)}...</div>
                        </td>
                        <td>${task.category_name}</td>
                        <td>${task.client_first_name} ${task.client_last_name || ''}</td>
                        <td>${task.price ? task.price.toLocaleString() + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</td>
                        <td>${task.deadline ? new Date(task.deadline).toLocaleDateString('ru-RU') : '‚Äî'}</td>
                        <td>
                            <span class="status-badge ${priorityClass}">
                                ${priorityText}
                            </span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-secondary btn-sm" onclick="viewAvailableTask(${task.id})">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-primary btn-sm" onclick="acceptTask(${task.id})">
                                    <i class="fas fa-check"></i> –ü—Ä–∏–Ω—è—Ç—å
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –º–æ–∏—Ö –∑–∞–¥–∞—á
        function loadMyTasksTable() {
            const container = document.getElementById('myTasksTable').querySelector('tbody');
            if (!container) return;
            
            // –¢–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ —ç—Ç–æ–º—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
            let filteredTasks = app.myTasks.filter(task => task.performer_id === app.currentPerformer.id);
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
            if (app.filters.status !== 'all') {
                filteredTasks = filteredTasks.filter(task => task.status === app.filters.status);
            }
            
            if (app.filters.dateFrom) {
                filteredTasks = filteredTasks.filter(task => 
                    new Date(task.created_at) >= new Date(app.filters.dateFrom)
                );
            }
            
            if (app.filters.dateTo) {
                filteredTasks = filteredTasks.filter(task => 
                    new Date(task.created_at) <= new Date(app.filters.dateTo + 'T23:59:59')
                );
            }
            
            container.innerHTML = filteredTasks.map(task => {
                const status = getStatusInfo(task.status);
                return `
                    <tr>
                        <td>
                            <div class="font-medium">${task.title}</div>
                            <div class="text-sm text-medium">#${task.task_number}</div>
                        </td>
                        <td>${task.client_first_name} ${task.client_last_name || ''}</td>
                        <td>${task.category_name}</td>
                        <td>
                            <span class="status-badge ${status.class}">
                                <i class="${status.icon}"></i>
                                ${status.name}
                            </span>
                        </td>
                        <td>${task.price ? task.price.toLocaleString() + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</td>
                        <td>${task.deadline ? new Date(task.deadline).toLocaleDateString('ru-RU') : '‚Äî'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-secondary btn-sm" onclick="viewTask(${task.id})">
                                    <i class="fas fa-eye"></i>
                                </button>
                                ${task.status === 'assigned' || task.status === 'in_progress' ? `
                                    <button class="btn btn-primary btn-sm" onclick="openPerformerChat(${task.id})">
                                        <i class="fas fa-comment"></i>
                                    </button>
                                ` : ''}
                                ${task.status === 'assigned' ? `
                                    <button class="btn btn-success btn-sm" onclick="startTask(${task.id})">
                                        <i class="fas fa-play"></i>
                                    </button>
                                ` : ''}
                                ${task.status === 'in_progress' ? `
                                    <button class="btn btn-warning btn-sm" onclick="completeTask(${task.id})">
                                        <i class="fas fa-check"></i>
                                    </button>
                                ` : ''}
                                ${['assigned', 'in_progress'].includes(task.status) ? `
                                    <button class="btn btn-error btn-sm" onclick="rejectTask(${task.id})">
                                        <i class="fas fa-times"></i>
                                    </button>
                                ` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á –≤ —Ä–∞–±–æ—Ç–µ
        async function loadInProgressTasks() {
            const container = document.getElementById('inProgressTable').querySelector('tbody');
            const noTasks = document.getElementById('noInProgressTasks');
            
            if (!container) return;
            
            try {
                const response = await fetch('/api/performer/tasks?status=in_progress', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const tasks = data.data.tasks;
                        
                        if (tasks.length === 0) {
                            container.innerHTML = '';
                            noTasks.style.display = 'block';
                            return;
                        }
                        
                        noTasks.style.display = 'none';
                        
                        container.innerHTML = tasks.map(task => {
                            return `
                                <tr>
                                    <td>
                                        <div class="font-medium">${task.title}</div>
                                        <div class="text-sm text-medium">#${task.task_number}</div>
                                    </td>
                                    <td>${task.client_first_name} ${task.client_last_name || ''}</td>
                                    <td>${task.category_name}</td>
                                    <td>${task.price ? task.price.toLocaleString() + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</td>
                                    <td>${task.deadline ? new Date(task.deadline).toLocaleDateString('ru-RU') : '‚Äî'}</td>
                                    <td>${new Date(task.updated_at).toLocaleString('ru-RU')}</td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn btn-secondary btn-sm" onclick="viewTask(${task.id})">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-primary btn-sm" onclick="openPerformerChat(${task.id})">
                                                <i class="fas fa-comment"></i>
                                            </button>
                                            <button class="btn btn-warning btn-sm" onclick="completeTask(${task.id})">
                                                <i class="fas fa-check"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        }).join('');
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á –≤ —Ä–∞–±–æ—Ç–µ:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
        async function loadCompletedTasks() {
            const container = document.getElementById('completedTable').querySelector('tbody');
            
            if (!container) return;
            
            try {
                const dateFrom = document.getElementById('completedDateFrom')?.value;
                const dateTo = document.getElementById('completedDateTo')?.value;
                
                let url = '/api/performer/tasks?status=completed&limit=50';
                if (dateFrom) url += `&date_from=${dateFrom}`;
                if (dateTo) url += `&date_to=${dateTo}`;
                
                const response = await fetch(url, {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const tasks = data.data.tasks;
                        
                        container.innerHTML = tasks.map(task => {
                            const stars = getStarsHTML(task.task_rating || 0);
                            
                            return `
                                <tr>
                                    <td>
                                        <div class="font-medium">${task.title}</div>
                                        <div class="text-sm text-medium">#${task.task_number}</div>
                                    </td>
                                    <td>${task.client_first_name} ${task.client_last_name || ''}</td>
                                    <td>${task.category_name}</td>
                                    <td>${task.price ? task.price.toLocaleString() + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</td>
                                    <td>${task.completed_at ? new Date(task.completed_at).toLocaleDateString('ru-RU') : '‚Äî'}</td>
                                    <td>
                                        ${task.task_rating ? `
                                            <div class="stars" style="font-size: 0.8rem;">
                                                ${stars}
                                            </div>
                                        ` : '‚Äî'}
                                    </td>
                                    <td>${task.feedback || '‚Äî'}</td>
                                </tr>
                            `;
                        }).join('');
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á:', error);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function updateCategoryFilter() {
            const filter = document.getElementById('categoryFilter');
            if (!filter) return;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            const currentValue = filter.value;
            
            // –û—á–∏—â–∞–µ–º –æ–ø—Ü–∏–∏ (–∫—Ä–æ–º–µ "–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏")
            while (filter.options.length > 1) {
                filter.remove(1);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
            const categories = app.performerCategories || app.allCategories || [];
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.display_name;
                filter.appendChild(option);
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
            filter.value = currentValue;
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        function applyFilters() {
            app.filters.category = document.getElementById('categoryFilter').value;
            app.filters.priority = document.getElementById('priorityFilter').value;
            app.filters.budgetFrom = document.getElementById('budgetFrom').value || null;
            
            loadAvailableTasksTable();
        }

        function applyMyTasksFilters() {
            app.filters.status = document.getElementById('statusFilter').value;
            app.filters.dateFrom = document.getElementById('dateFrom').value;
            app.filters.dateTo = document.getElementById('dateTo').value;
            
            loadMyTasksTable();
        }

        function resetFilters() {
            document.getElementById('categoryFilter').value = 'all';
            document.getElementById('priorityFilter').value = 'all';
            document.getElementById('budgetFrom').value = '';
            
            app.filters = {
                category: 'all',
                priority: 'all',
                budgetFrom: null
            };
            
            loadAvailableTasksTable();
        }

        // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω–æ–π –∑–∞–¥–∞—á–∏
        async function viewAvailableTask(taskId) {
            const task = app.availableTasks.find(t => t.id === taskId);
            if (!task) return;
            
            const html = `
                <div class="content-header">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <button class="btn btn-secondary" onclick="navigateToSection('available-tasks')" style="padding: 8px 16px;">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <h1 class="content-title">–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–¥–∞—á–∏</h1>
                    </div>
                </div>
                
                <div class="card" style="padding: 24px; margin-bottom: 24px;">
                    <h3 style="font-size: 1.3rem; margin-bottom: 16px; color: var(--graphite-dark);">${task.title}</h3>
                    
                    <div class="grid grid-2" style="gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</h4>
                            <p style="font-weight: 500;">${task.category_name}</p>
                        </div>
                        <div>
                            <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ë—é–¥–∂–µ—Ç</h4>
                            <p style="font-weight: 500; color: var(--blue-primary);">
                                ${task.price ? task.price.toLocaleString() + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}
                            </p>
                        </div>
                        <div>
                            <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–î–µ–¥–ª–∞–π–Ω</h4>
                            <p style="font-weight: 500;">${task.deadline ? new Date(task.deadline).toLocaleDateString('ru-RU') : '‚Äî'}</p>
                        </div>
                        <div>
                            <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ö–ª–∏–µ–Ω—Ç</h4>
                            <p style="font-weight: 500;">${task.client_first_name} ${task.client_last_name || ''}</p>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–û–ø–∏—Å–∞–Ω–∏–µ</h4>
                        <p style="line-height: 1.6;">${task.description}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ê–¥—Ä–µ—Å</h4>
                        <p style="font-weight: 500;">${task.address}</p>
                    </div>
                    
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-secondary" onclick="navigateToSection('available-tasks')">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                        <button class="btn btn-primary" onclick="acceptTask(${task.id})">
                            <i class="fas fa-check"></i> –ü—Ä–∏–Ω—è—Ç—å –∑–∞–¥–∞—á—É
                        </button>
                    </div>
                </div>
            `;
            
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = html;
        }

        // –ü—Ä–∏–Ω—è—Ç—å –∑–∞–¥–∞—á—É
        async function acceptTask(taskId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–Ω—è—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')) {
                return;
            }
            
            showLoading('–ü—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–¥–∞—á–∏...');
            
            try {
                const response = await fetch(`/api/performer/tasks/${taskId}/accept`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${app.token}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–Ω—è—Ç–∞!', 'success');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    await loadAvailableTasks();
                    await loadMyTasks();
                    await loadPerformerStats();
                    
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–¥–∞—á
                    navigateToSection('my-tasks');
                    
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞–¥–∞—á–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞–¥–∞—á–∏:', error);
                showNotification(error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // –û—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –∑–∞–¥–∞—á–∏
        async function rejectTask(taskId) {
            const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–∞–∑–∞ –æ—Ç –∑–∞–¥–∞—á–∏:', '–ù–µ –º–æ–≥—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å');
            
            if (reason === null) return; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª
            
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç —ç—Ç–æ–π –∑–∞–¥–∞—á–∏?')) {
                return;
            }
            
            showLoading('–û—Ç–∫–∞–∑ –æ—Ç –∑–∞–¥–∞—á–∏...');
            
            try {
                const response = await fetch(`/api/performer/tasks/${taskId}/reject`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.token}`
                    },
                    body: JSON.stringify({ reason })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–í—ã –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å –æ—Ç –∑–∞–¥–∞—á–∏', 'info');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    await loadAvailableTasks();
                    await loadMyTasks();
                    await loadPerformerStats();
                    
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–¥–∞—á
                    navigateToSection('my-tasks');
                    
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –æ—Ç–∫–∞–∑–∞ –æ—Ç –∑–∞–¥–∞—á–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫–∞–∑–∞ –æ—Ç –∑–∞–¥–∞—á–∏:', error);
                showNotification(error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // –ü—Ä–æ—Å–º–æ—Ç—Ä –º–æ–µ–π –∑–∞–¥–∞—á–∏
        async function viewTask(taskId) {
            showLoading('–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á–∏...');
            
            try {
                const response = await fetch(`/api/tasks/${taskId}`, {
                    headers: {
                        'Authorization': `Bearer ${app.token}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const task = data.data.task;
                    app.currentTaskId = taskId;
                    
                    const html = `
                        <div class="content-header">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <button class="btn btn-secondary" onclick="navigateToSection('my-tasks')" style="padding: 8px 16px;">
                                    <i class="fas fa-arrow-left"></i>
                                </button>
                                <h1 class="content-title">${task.title}</h1>
                            </div>
                        </div>
                        
                        <div class="card" style="padding: 24px; margin-bottom: 24px;">
                            <div class="grid grid-4" style="gap: 20px; margin-bottom: 24px;">
                                <div>
                                    <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–°—Ç–∞—Ç—É—Å</h4>
                                    <span class="status-badge ${task.status}">
                                        ${getStatusText(task.status)}
                                    </span>
                                </div>
                                <div>
                                    <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ë—é–¥–∂–µ—Ç</h4>
                                    <p style="font-weight: 500; color: var(--blue-primary);">
                                        ${task.price ? task.price.toLocaleString() + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}
                                    </p>
                                </div>
                                <div>
                                    <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–î–µ–¥–ª–∞–π–Ω</h4>
                                    <p style="font-weight: 500;">${task.deadline ? new Date(task.deadline).toLocaleDateString('ru-RU') : '‚Äî'}</p>
                                </div>
                                <div>
                                    <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ö–ª–∏–µ–Ω—Ç</h4>
                                    <p style="font-weight: 500;">${task.client_first_name} ${task.client_last_name || ''}</p>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–û–ø–∏—Å–∞–Ω–∏–µ</h4>
                                <p style="line-height: 1.6;">${task.description}</p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ê–¥—Ä–µ—Å</h4>
                                <p style="font-weight: 500;">${task.address}</p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–ö–æ–Ω—Ç–∞–∫—Ç</h4>
                                <p style="font-weight: 500;">${task.contact_info}</p>
                            </div>
                            
                            ${task.additional_requirements ? `
                            <div style="margin-bottom: 20px;">
                                <h4 style="font-size: 0.9rem; color: var(--graphite-medium); margin-bottom: 8px;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h4>
                                <p style="line-height: 1.6;">${task.additional_requirements}</p>
                            </div>
                            ` : ''}
                            
                            <div style="display: flex; gap: 12px; margin-top: 24px;">
                                <button class="btn btn-secondary" onclick="navigateToSection('my-tasks')">
                                    <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                                </button>
                                
                                ${task.status === 'assigned' ? `
                                    <button class="btn btn-success" onclick="startTask(${task.id})">
                                        <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É
                                    </button>
                                ` : ''}
                                
                                ${task.status === 'in_progress' ? `
                                    <button class="btn btn-warning" onclick="completeTask(${task.id})">
                                        <i class="fas fa-check"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É
                                    </button>
                                ` : ''}
                                
                                ${['assigned', 'in_progress'].includes(task.status) ? `
                                    <button class="btn btn-error" onclick="rejectTask(${task.id})">
                                        <i class="fas fa-times"></i> –û—Ç–∫–∞–∑–∞—Ç—å—Å—è
                                    </button>
                                ` : ''}
                                
                                <button class="btn btn-primary" onclick="openPerformerChat(${task.id})">
                                    <i class="fas fa-comment"></i> –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç
                                </button>
                            </div>
                        </div>
                    `;
                    
                    const contentArea = document.getElementById('contentArea');
                    contentArea.innerHTML = html;
                    
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á–∏', 'error');
                navigateToSection('my-tasks');
            } finally {
                hideLoading();
            }
        }

        // –ù–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
        async function startTask(taskId) {
            if (!confirm('–ù–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏?')) {
                return;
            }
            
            showLoading('–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã...');
            
            try {
                const response = await fetch(`/api/performer/tasks/${taskId}/start`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${app.token}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–†–∞–±–æ—Ç–∞ –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π –Ω–∞—á–∞—Ç–∞!', 'success');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    await loadMyTasks();
                    await loadPerformerStats();
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∑–∞–¥–∞—á—É
                    if (app.currentTaskId === taskId) {
                        viewTask(taskId);
                    }
                    
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã:', error);
                showNotification(error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É
        async function completeTask(taskId) {
            if (!confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏?')) {
                return;
            }
            
            showLoading('–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏...');
            
            try {
                const response = await fetch(`/api/performer/tasks/${taskId}/complete`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${app.token}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ó–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.', 'success');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    await loadMyTasks();
                    await loadPerformerStats();
                    
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–¥–∞—á
                    navigateToSection('my-tasks');
                    
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏:', error);
                showNotification(error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // === –†–ê–ë–û–ß–ò–ô –ß–ê–¢ ===

        // –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–º
        async function openPerformerChat(taskId) {
            showLoading('–û—Ç–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞...');
            
            try {
                const response = await fetch(`/api/tasks/${taskId}`, {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentChatTask = data.data.task;
                    performerChatMessages = data.data.messages || [];
                    
                    renderPerformerChat();
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–∞');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞', 'error');
            } finally {
                hideLoading();
            }
        }

        // –†–µ–Ω–¥–µ—Ä —á–∞—Ç–∞
        function renderPerformerChat() {
            const contentArea = document.getElementById('contentArea');
            
            contentArea.innerHTML = `
                <div class="content-header">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <button class="btn btn-secondary" onclick="navigateToSection('my-tasks')" style="padding: 8px 16px;">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <h1 class="content-title">–ß–∞—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–º</h1>
                    </div>
                </div>
                
                <div class="task-chat-container">
                    <div class="chat-header">
                        <h3>${currentChatTask.title}</h3>
                        <div style="font-size: 0.9rem; opacity: 0.9;">
                            –ö–ª–∏–µ–Ω—Ç: ${currentChatTask.client_first_name} ${currentChatTask.client_last_name || ''}
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="performerMessages">
                        ${performerChatMessages.length === 0 ? `
                            <div class="no-messages">
                                <i class="fas fa-comments"></i>
                                <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                                <p class="text-sm">–ù–∞—á–Ω–∏—Ç–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</p>
                            </div>
                        ` : performerChatMessages.map(msg => {
                            const isCurrentUser = msg.user_id === app.currentPerformer.id;
                            return `
                                <div class="chat-message ${isCurrentUser ? 'sent' : 'received'}">
                                    ${!isCurrentUser ? `<div class="message-sender">${msg.first_name}</div>` : ''}
                                    <div class="message-bubble">${msg.message}</div>
                                    <div class="message-time">
                                        ${new Date(msg.created_at).toLocaleString('ru-RU')}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="chat-input-area">
                        <textarea 
                            class="chat-input" 
                            id="performerChatInput" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                            onkeydown="handlePerformerChatKeydown(event)"
                        ></textarea>
                        <button 
                            class="send-message-btn" 
                            onclick="sendPerformerChatMessage()"
                            id="sendPerformerChatBtn"
                        >
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            `;
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            const messagesContainer = document.getElementById('performerMessages');
            if (messagesContainer) {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            const input = document.getElementById('performerChatInput');
            if (input) {
                input.focus();
            }
            
            // –ù–∞—á–∏–Ω–∞–µ–º –æ–ø—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π
            startPerformerChatPolling();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        async function loadPerformerChatMessages() {
            if (!currentChatTask) return;
            
            try {
                const response = await fetch(`/api/tasks/${currentChatTask.id}/messages`, {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    performerChatMessages = data.data.messages || [];
                    const messagesContainer = document.getElementById('performerMessages');
                    if (messagesContainer) {
                        messagesContainer.innerHTML = performerChatMessages.length === 0 ? `
                            <div class="no-messages">
                                <i class="fas fa-comments"></i>
                                <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                                <p class="text-sm">–ù–∞—á–Ω–∏—Ç–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</p>
                            </div>
                        ` : performerChatMessages.map(msg => {
                            const isCurrentUser = msg.user_id === app.currentPerformer.id;
                            return `
                                <div class="chat-message ${isCurrentUser ? 'sent' : 'received'}">
                                    ${!isCurrentUser ? `<div class="message-sender">${msg.first_name}</div>` : ''}
                                    <div class="message-bubble">${msg.message}</div>
                                    <div class="message-time">
                                        ${new Date(msg.created_at).toLocaleString('ru-RU')}
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:', error);
            }
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        async function sendPerformerChatMessage() {
            if (!currentChatTask) return;
            
            const input = document.getElementById('performerChatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const sendBtn = document.getElementById('sendPerformerChatBtn');
            sendBtn.disabled = true;
            
            try {
                const response = await fetch(`/api/tasks/${currentChatTask.id}/messages`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.token}`
                    },
                    body: JSON.stringify({ message })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    input.value = '';
                    await loadPerformerChatMessages();
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è', 'error');
            } finally {
                sendBtn.disabled = false;
                input.focus();
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ —á–∞—Ç–µ
        function handlePerformerChatKeydown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendPerformerChatMessage();
            }
        }

        // –û–ø—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π
        function startPerformerChatPolling() {
            if (performerChatPolling) {
                clearInterval(performerChatPolling);
            }
            
            performerChatPolling = setInterval(async () => {
                await loadPerformerChatMessages();
            }, 3000);
        }

        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–ø—Ä–æ—Å –ø—Ä–∏ —É—Ö–æ–¥–µ
        function stopPerformerChatPolling() {
            if (performerChatPolling) {
                clearInterval(performerChatPolling);
                performerChatPolling = null;
            }
            currentChatTask = null;
            performerChatMessages = [];
        }

        // === –ö–û–ù–ï–¶ –ß–ê–¢–ê ===

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è
        function loadProfileData() {
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ñ–∏–ª—è
            document.getElementById('editFirstName').value = app.currentPerformer.first_name;
            document.getElementById('editLastName').value = app.currentPerformer.last_name;
            document.getElementById('editPhone').value = app.currentPerformer.phone;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –≤ —Å–µ–∫—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
            const profileFullName = document.getElementById('profileFullName');
            const profileEmail = document.getElementById('profileEmail');
            const profilePhone = document.getElementById('profilePhone');
            const profileRating = document.getElementById('profileRating');
            
            if (profileFullName) {
                profileFullName.textContent = `${app.currentPerformer.first_name} ${app.currentPerformer.last_name}`;
            }
            
            if (profileEmail) {
                profileEmail.textContent = app.currentPerformer.email;
            }
            
            if (profilePhone) {
                profilePhone.textContent = app.currentPerformer.phone;
            }
            
            if (profileRating && app.performerStats) {
                profileRating.textContent = (app.performerStats.stats.avg_rating || 0).toFixed(1);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const profileCategories = document.getElementById('profileCategories');
            const editCategories = document.getElementById('editCategories');
            
            if (profileCategories && app.performerStats) {
                const categories = app.performerStats.categories || [];
                profileCategories.innerHTML = categories.map(cat => `
                    <span class="category-tag">
                        ${cat.display_name}
                        ${cat.experience_years ? `<span class="text-xs">(${cat.experience_years} –ª–µ—Ç)</span>` : ''}
                    </span>
                `).join('');
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            if (editCategories && app.allCategories.length > 0) {
                const performerCatIds = (app.performerStats?.categories || []).map(c => c.id);
                
                editCategories.innerHTML = app.allCategories.map(cat => `
                    <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" 
                               value="${cat.id}" 
                               ${performerCatIds.includes(cat.id) ? 'checked' : ''}
                               class="category-checkbox">
                        <span class="category-tag" style="cursor: pointer;">
                            ${cat.display_name}
                        </span>
                    </label>
                `).join('');
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—Ñ–∏–ª—è
        async function saveProfileSettings() {
            showLoading('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫...');
            
            try {
                // –°–æ–±–∏—Ä–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const categoryCheckboxes = document.querySelectorAll('.category-checkbox:checked');
                const selectedCategories = Array.from(categoryCheckboxes).map(cb => cb.value);
                
                const response = await fetch('/api/performer/profile', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${app.token}`
                    },
                    body: JSON.stringify({
                        first_name: document.getElementById('editFirstName').value,
                        last_name: document.getElementById('editLastName').value,
                        phone: document.getElementById('editPhone').value,
                        availability: document.getElementById('availabilityStatus').value,
                        max_tasks: document.getElementById('maxTasks').value,
                        min_budget: document.getElementById('minBudget').value,
                        categories: selectedCategories
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    await loadPerformerData();
                    await loadPerformerCategories();
                } else {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫', 'error');
            } finally {
                hideLoading();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤
        function loadReviews() {
            const container = document.getElementById('reviewsGrid');
            if (!container || !app.performerStats) return;
            
            const reviews = app.performerStats.recent_reviews || [];
            
            if (reviews.length === 0) {
                container.innerHTML = `
                    <div class="no-messages" style="grid-column: 1 / -1;">
                        <i class="fas fa-star"></i>
                        <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤</p>
                        <p class="text-sm">–û—Ç–∑—ã–≤—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = reviews.map(review => `
                <div class="review-card">
                    <div class="review-header">
                        <div class="review-client">${review.client_first_name} ${review.client_last_name || ''}</div>
                        <div class="review-date">${new Date(review.created_at).toLocaleDateString('ru-RU')}</div>
                    </div>
                    <div class="stars">
                        ${getStarsHTML(review.rating)}
                    </div>
                    ${review.comment ? `
                        <div class="review-comment">${review.comment}</div>
                    ` : ''}
                    <div class="text-sm text-medium" style="margin-top: 8px;">
                        –ó–∞–¥–∞—á–∞: ${review.task_title}
                    </div>
                </div>
            `).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞—Ä–∞–±–æ—Ç–∫–µ
        async function loadEarningsData() {
            try {
                const response = await fetch('/api/performer/earnings?period=month', {
                    headers: { 'Authorization': `Bearer ${app.token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const earnings = data.data;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                        document.getElementById('totalEarningsAmount').textContent = 
                            (earnings.total_earnings || 0).toLocaleString() + ' ‚ÇΩ';
                        document.getElementById('monthlyEarnings').textContent = 
                            (earnings.total_earnings || 0).toLocaleString() + ' ‚ÇΩ';
                        document.getElementById('weeklyEarnings').textContent = 
                            '0 ‚ÇΩ'; // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç
                        document.getElementById('avgTaskPrice').textContent = 
                            '0 ‚ÇΩ'; // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç
                        
                        // –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏
                        const historyTable = document.getElementById('earningsHistoryTable').querySelector('tbody');
                        if (historyTable && earnings.monthly_earnings) {
                            historyTable.innerHTML = earnings.monthly_earnings.map(item => `
                                <tr>
                                    <td>${item.month}</td>
                                    <td>${item.tasks_count || 0}</td>
                                    <td>${(item.earnings || 0).toLocaleString()} ‚ÇΩ</td>
                                    <td>${item.tasks_count > 0 ? Math.round(item.earnings / item.tasks_count).toLocaleString() : 0} ‚ÇΩ</td>
                                </tr>
                            `).join('');
                        }
                        
                        // –¢–∞–±–ª–∏—Ü–∞ –≤—ã–ø–ª–∞—Ç
                        const payoutsTable = document.getElementById('payoutsTable').querySelector('tbody');
                        if (payoutsTable && earnings.recent_payments) {
                            payoutsTable.innerHTML = earnings.recent_payments.map(payment => `
                                <tr>
                                    <td>${new Date(payment.created_at).toLocaleDateString('ru-RU')}</td>
                                    <td>${Math.abs(payment.amount).toLocaleString()} ‚ÇΩ</td>
                                    <td>${payment.payment_method || '–ö–∞—Ä—Ç–∞'}</td>
                                    <td><span class="status-badge ${payment.status === 'completed' ? 'status-completed' : 'status-in-progress'}">${payment.status === 'completed' ? '–í—ã–ø–ª–∞—á–µ–Ω–æ' : '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ'}</span></td>
                                    <td>${payment.description || ''}</td>
                                </tr>
                            `).join('');
                        }
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞—Ä–∞–±–æ—Ç–∫–µ:', error);
            }
        }

        // –ó–∞–ø—Ä–æ—Å –≤—ã–ø–ª–∞—Ç—ã
        async function requestPayout() {
            const amountInput = document.getElementById('payoutAmount');
            const amount = parseInt(amountInput.value);
            
            if (!amount || amount < 1000) {
                showNotification('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã - 1 000 ‚ÇΩ', 'error');
                return;
            }
            
            if (!confirm(`–ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É ${amount.toLocaleString()} ‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É?`)) {
                return;
            }
            
            showLoading('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –≤—ã–ø–ª–∞—Ç—É...');
            
            try {
                // –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                if (true) { // DEMO_MODE
                    setTimeout(() => {
                        showNotification(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø–ª–∞—Ç—É ${amount.toLocaleString()} ‚ÇΩ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! (–î–µ–º–æ-—Ä–µ–∂–∏–º)`, 'success');
                        amountInput.value = '';
                        hideLoading();
                    }, 1000);
                } else {
                    // –†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ API
                    // const response = await fetch('/api/performer/payout', {...});
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤—ã–ø–ª–∞—Ç—ã:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤—ã–ø–ª–∞—Ç—ã', 'error');
                hideLoading();
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getStatusInfo(status) {
            const statuses = {
                new: { name: '–ù–æ–≤—ã–π', class: 'status-new', icon: 'fas fa-plus-circle' },
                searching: { name: '–í –ø–æ–∏—Å–∫–µ', class: 'status-search', icon: 'fas fa-search' },
                assigned: { name: '–ù–∞–∑–Ω–∞—á–µ–Ω', class: 'status-assigned', icon: 'fas fa-user-check' },
                in_progress: { name: '–í —Ä–∞–±–æ—Ç–µ', class: 'status-in-progress', icon: 'fas fa-spinner' },
                completed: { name: '–ó–∞–≤–µ—Ä—à–µ–Ω', class: 'status-completed', icon: 'fas fa-check-circle' },
                cancelled: { name: '–û—Ç–º–µ–Ω–µ–Ω', class: 'status-cancelled', icon: 'fas fa-times-circle' }
            };
            
            return statuses[status] || statuses.new;
        }

        function getStatusText(status) {
            const statusMap = {
                'new': '–ù–æ–≤—ã–π',
                'searching': '–í –ø–æ–∏—Å–∫–µ',
                'assigned': '–ù–∞–∑–Ω–∞—á–µ–Ω',
                'in_progress': '–í —Ä–∞–±–æ—Ç–µ',
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
            };
            return statusMap[status] || status;
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function navigateToMainApp() {
            stopPerformerChatPolling();
            window.location.href = '/index.html';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        function checkMessages() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–¥–∞—á–∏ —Å –Ω–æ–≤—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
            const tasksWithUnread = app.myTasks.filter(task => 
                task.status === 'assigned' || task.status === 'in_progress'
            );
            
            if (tasksWithUnread.length > 0) {
                showNotification(`–£ –≤–∞—Å ${tasksWithUnread.length} –∑–∞–¥–∞—á –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è`, 'info');
                navigateToSection('my-tasks');
            } else {
                showNotification('–ù–µ—Ç –∑–∞–¥–∞—á —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —á–∞—Ç–∞–º–∏', 'info');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
        async function updateAvailability() {
            const currentStatus = document.getElementById('availabilityStatus')?.value || 'available';
            const statuses = {
                available: '–î–æ—Å—Ç—É–ø–µ–Ω',
                busy: '–ó–∞–Ω—è—Ç',
                away: '–ù–µ –Ω–∞ –º–µ—Å—Ç–µ'
            };
            
            const newStatus = prompt('–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:\n1. available - –î–æ—Å—Ç—É–ø–µ–Ω\n2. busy - –ó–∞–Ω—è—Ç\n3. away - –ù–µ –Ω–∞ –º–µ—Å—Ç–µ', currentStatus);
            
            if (newStatus && ['available', 'busy', 'away'].includes(newStatus)) {
                try {
                    const response = await fetch('/api/performer/availability', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${app.token}`
                        },
                        body: JSON.stringify({ availability: newStatus })
                    });
                    
                    if (response.ok) {
                        showNotification(`–°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${statuses[newStatus]}`, 'success');
                        if (document.getElementById('availabilityStatus')) {
                            document.getElementById('availabilityStatus').value = newStatus;
                        }
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
                    showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞', 'error');
                }
            }
        }

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function logout() {
            stopPerformerChatPolling();
            localStorage.removeItem('token');
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            if (!container) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            notification.innerHTML = `
                <i class="${icons[type] || icons.info}"></i>
                <div style="flex: 1;">${message}</div>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; cursor: pointer; color: var(--graphite-light);">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // –ó–∞–ø—É—Å–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function startNotifications() {
            // –ò–º–∏—Ç–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
            setInterval(async () => {
                if (Math.random() > 0.8) { // 20% chance
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                    try {
                        const response = await fetch('/api/performer/tasks/available/count', {
                            headers: { 'Authorization': `Bearer ${app.token}` }
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            if (data.success && data.data.count > app.availableTasks.length) {
                                showNotification('–ü–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏!', 'info');
                                await loadAvailableTasks();
                            }
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á:', error);
                    }
                }
            }, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    if (this.getAttribute('data-section')) {
                        e.preventDefault();
                        const section = this.getAttribute('data-section');
                        navigateToSection(section);
                    }
                });
            });
            
            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–∞—Ç–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            window.addEventListener('beforeunload', stopPerformerChatPolling);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞
        function showLoading(text = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.querySelector('.loading-text');
            
            if (overlay && loadingText) {
                loadingText.textContent = text;
                overlay.classList.add('active');
            }
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.navigateToSection = navigateToSection;
        window.viewAvailableTask = viewAvailableTask;
        window.acceptTask = acceptTask;
        window.rejectTask = rejectTask;
        window.viewTask = viewTask;
        window.startTask = startTask;
        window.completeTask = completeTask;
        window.openPerformerChat = openPerformerChat;
        window.sendPerformerChatMessage = sendPerformerChatMessage;
        window.handlePerformerChatKeydown = handlePerformerChatKeydown;
        window.saveProfileSettings = saveProfileSettings;
        window.navigateToMainApp = navigateToMainApp;
        window.checkMessages = checkMessages;
        window.updateAvailability = updateAvailability;
        window.applyFilters = applyFilters;
        window.applyMyTasksFilters = applyMyTasksFilters;
        window.resetFilters = resetFilters;
        window.loadCompletedTasks = loadCompletedTasks;
        window.requestPayout = requestPayout;
        window.logout = logout;
        window.stopPerformerChatPolling = stopPerformerChatPolling;
    </script>
</body>
</html>
