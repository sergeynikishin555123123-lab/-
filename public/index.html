<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>üéÄ –ö–æ–Ω—Å—å–µ—Ä–∂-—Å–µ—Ä–≤–∏—Å | –õ–∏–Ω–∏–∏ –∑–∞–¥–∞—á</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –±—ã–ª–∏, –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ */
        :root {
            --pink-primary: #FF6B8B;
            --pink-light: #FFB6C1;
            --pink-dark: #D81B60;
            --pink-gradient: linear-gradient(135deg, #FF6B8B 0%, #FFB6C1 100%);
            --pink-gradient-dark: linear-gradient(135deg, #D81B60 0%, #FF6B8B 100%);
            --light-bg: #FFF5F7;
            --white: #FFFFFF;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --info: #3B82F6;
            --shadow-sm: 0 1px 3px rgba(255, 107, 139, 0.12);
            --shadow: 0 4px 6px -1px rgba(255, 107, 139, 0.1);
            --shadow-md: 0 10px 15px -3px rgba(255, 107, 139, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(255, 107, 139, 0.15);
            --radius-sm: 12px;
            --radius: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--light-bg);
            color: var(--gray-800);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .app-header {
            background: var(--white);
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 0 20px;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }
        
        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--pink-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 1.8rem;
        }
        
        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        .nav-link {
            color: var(--gray-700);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: var(--radius);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-link:hover {
            color: var(--pink-primary);
            background: var(--light-bg);
        }
        
        .nav-link.active {
            background: var(--pink-gradient);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--pink-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            cursor: pointer;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--pink-primary);
            cursor: pointer;
        }
        
        /* –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            margin-top: 70px;
            min-height: calc(100vh - 140px);
        }
        
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –§—É—Ç–µ—Ä */
        .app-footer {
            background: var(--gray-900);
            color: white;
            padding: 40px 20px;
            margin-top: 60px;
            border-top: 4px solid var(--pink-primary);
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }
        
        .footer-section h3 {
            color: var(--white);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: var(--gray-300);
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .footer-links a:hover {
            color: var(--white);
            transform: translateX(5px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 30px;
            margin-top: 30px;
            border-top: 1px solid var(--gray-700);
            color: var(--gray-400);
            font-size: 0.9rem;
        }
        
        /* –ë—É—Ä–≥–µ—Ä –º–µ–Ω—é –¥–ª—è –º–æ–±–∏–ª–æ–∫ */
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            
            .nav-menu {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: var(--white);
                flex-direction: column;
                padding: 20px;
                box-shadow: var(--shadow-lg);
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: var(--transition);
                z-index: 999;
            }
            
            .nav-menu.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            
            .nav-link {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }
        
        .btn-primary {
            background: var(--pink-gradient);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: white;
            color: var(--pink-primary);
            border: 2px solid var(--pink-primary);
        }
        
        .btn-secondary:hover {
            background: var(--light-bg);
        }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 2px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        var(--pink-gradient) border-box;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        /* Grid —Å–∏—Å—Ç–µ–º—ã */
        .grid {
            display: grid;
            gap: 24px;
        }
        
        .grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .grid-4 {
            grid-template-columns: repeat(4, 1fr);
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--gray-200);
            border-top: 4px solid var(--pink-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-500);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: var(--radius);
            color: white;
            font-weight: 500;
            box-shadow: var(--shadow-lg);
            z-index: 2000;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 400px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification.success {
            background: linear-gradient(135deg, var(--success), #34D399);
        }
        
        .notification.error {
            background: linear-gradient(135deg, var(--danger), #F87171);
        }
        
        .notification.info {
            background: linear-gradient(135deg, var(--info), #60A5FA);
        }
        
        /* –ú–æ–¥–∞–ª–∫–∏ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius-xl);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }
        
        @keyframes modalIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        /* –¢–∞–±–ª–∏—Ü—ã */
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th {
            background: var(--light-bg);
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--gray-700);
            border-bottom: 2px solid var(--gray-200);
        }
        
        .table td {
            padding: 16px;
            border-bottom: 1px solid var(--gray-100);
        }
        
        .table tr:hover {
            background: var(--gray-50);
        }
        
        /* –°—Ç–∞—Ç—É—Å –±–∞–¥–∂–∏ */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-success {
            background: #D1FAE5;
            color: #047857;
        }
        
        .badge-warning {
            background: #FEF3C7;
            color: #D97706;
        }
        
        .badge-danger {
            background: #FEE2E2;
            color: #DC2626;
        }
        
        .badge-info {
            background: #DBEAFE;
            color: #1D4ED8;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1024px) {
            .grid-4 {
                grid-template-columns: repeat(3, 1fr);
            }
            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .grid-4, .grid-3, .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 0 15px;
            }
            
            .main-content {
                margin-top: 60px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ */
        .wizard-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .wizard-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .wizard-step.active {
            display: block;
        }
        
        .wizard-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .wizard-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .wizard-progress:before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gray-200);
            z-index: 1;
        }
        
        .wizard-step-indicator {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }
        
        .wizard-step-circle {
            width: 40px;
            height: 40px;
            background: var(--gray-200);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 600;
            color: var(--gray-500);
            transition: var(--transition);
        }
        
        .wizard-step-indicator.active .wizard-step-circle {
            background: var(--pink-gradient);
            color: white;
        }
        
        .wizard-step-indicator.completed .wizard-step-circle {
            background: var(--success);
            color: white;
        }
        
        .wizard-content {
            background: white;
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-md);
            margin-bottom: 30px;
        }
        
        .wizard-footer {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        
        /* –ß–∞—Ç –∑–∞–¥–∞—á–∏ */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }
        
        .chat-header {
            background: var(--pink-gradient);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: var(--gray-50);
        }
        
        .chat-message {
            margin-bottom: 20px;
            max-width: 70%;
        }
        
        .chat-message.own {
            margin-left: auto;
        }
        
        .chat-message-content {
            background: white;
            padding: 15px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
        }
        
        .chat-message.own .chat-message-content {
            background: var(--pink-gradient);
            color: white;
        }
        
        .chat-input {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: white;
            border-top: 1px solid var(--gray-200);
        }
        
        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
        }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
        .category-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--pink-primary);
        }
        
        .category-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .category-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--gray-900);
        }
        
        .category-description {
            color: var(--gray-600);
            margin-bottom: 20px;
        }
        
        /* –¢–æ–ø —É—Å–ª—É–≥–∏ */
        .top-services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .top-service-card {
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border-left: 4px solid var(--pink-primary);
        }
        
        .top-service-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        .top-service-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--gray-900);
        }
        
        .top-service-description {
            color: var(--gray-600);
            font-size: 0.9rem;
        }
        
        /* –®–ø–∞—Ä–≥–∞–ª–∫–∞ */
        .cheatsheet-card {
            background: var(--light-bg);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--warning);
        }
        
        .cheatsheet-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--gray-900);
        }
        
        .cheatsheet-content {
            color: var(--gray-700);
            line-height: 1.6;
        }
        
        /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ */
        .hint-card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }
        
        .hint-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--pink-primary);
        }
        
        .hint-content {
            color: var(--gray-700);
            line-height: 1.6;
        }
        
        /* –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ */
        .task-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .status-new {
            background: #FFE4E6;
            color: #E11D48;
        }
        
        .status-assigned {
            background: #DBEAFE;
            color: #1D4ED8;
        }
        
        .status-in_progress {
            background: #FEF3C7;
            color: #D97706;
        }
        
        .status-completed {
            background: #D1FAE5;
            color: #047857;
        }
        
        .status-cancelled {
            background: #F3F4F6;
            color: #6B7280;
        }
    </style>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <header class="app-header">
        <div class="nav-container">
            <a href="#" class="logo" onclick="navigate('home')">
                <i class="fas fa-heart"></i>
                –ö–æ–Ω—Å—å–µ—Ä–∂ –°–µ—Ä–≤–∏—Å
            </a>
            
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav class="nav-menu" id="navMenu">
                <a href="#" class="nav-link active" onclick="navigate('home')">
                    <i class="fas fa-home"></i>
                    –ì–ª–∞–≤–Ω–∞—è
                </a>
                <a href="#" class="nav-link" onclick="navigate('subscriptions')">
                    <i class="fas fa-crown"></i>
                    –ü–æ–¥–ø–∏—Å–∫–∏
                </a>
                <a href="#" class="nav-link" onclick="navigate('services')">
                    <i class="fas fa-concierge-bell"></i>
                    –õ–∏–Ω–∏–∏ –∑–∞–¥–∞—á
                </a>
                <a href="#" class="nav-link" onclick="navigate('tasks')">
                    <i class="fas fa-tasks"></i>
                    –ú–æ–∏ –∑–∞–¥–∞—á–∏
                </a>
                <a href="#" class="nav-link" onclick="navigate('profile')">
                    <i class="fas fa-user"></i>
                    –ü—Ä–æ—Ñ–∏–ª—å
                </a>
                <div class="user-menu" id="userMenu">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </nav>
        </div>
    </header>

    <!-- –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –ì–ª–∞–≤–Ω–∞—è -->
        <section id="page-home" class="page active">
            <div class="container">
                <!-- –ì–µ—Ä–æ–π —Å–µ–∫—Ü–∏—è -->
                <div class="hero-section" style="padding: 80px 0; text-align: center;">
                    <h1 style="font-size: 3rem; margin-bottom: 20px; color: var(--gray-900);">
                        –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∑–∞–¥–∞—á–∞–º
                    </h1>
                    <p style="font-size: 1.2rem; color: var(--gray-600); max-width: 600px; margin: 0 auto 40px;">
                        –í—ã–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏—é –∑–∞–¥–∞—á–∏, –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏, —Å–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∑–∞—è–≤–∫—É –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
                    </p>
                    <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="navigate('services')">
                            <i class="fas fa-play-circle"></i>
                            –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
                        </button>
                        <button class="btn btn-secondary" onclick="navigate('subscriptions')">
                            <i class="fas fa-crown"></i>
                            –í—ã–±—Ä–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
                        </button>
                    </div>
                </div>

                <!-- –¢–æ–ø —É—Å–ª—É–≥–∏ -->
                <div class="services-preview" style="margin: 80px 0;">
                    <div style="text-align: center; margin-bottom: 40px;">
                        <h2 class="section-title">–¢–æ–ø —É—Å–ª—É–≥–∏ —ç—Ç–æ–≥–æ —Å–µ–∑–æ–Ω–∞</h2>
                        <p id="topServicesTitle" style="color: var(--gray-600); margin-top: 10px;">
                            –ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏
                        </p>
                    </div>
                    <div class="top-services-grid" id="topServicesGrid">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>

                <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ª–∏–Ω–∏–∏ –∑–∞–¥–∞—á -->
                <div class="services-preview" style="margin: 80px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
                        <h2 class="section-title">–õ–∏–Ω–∏–∏ –∑–∞–¥–∞—á</h2>
                        <a href="#" class="btn btn-secondary" onclick="navigate('services')">
                            –í—Å–µ –ª–∏–Ω–∏–∏
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                    <div class="grid grid-3" id="popularCategories">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>

                <!-- –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç -->
                <div style="margin: 80px 0; background: white; border-radius: var(--radius-xl); padding: 60px 40px; box-shadow: var(--shadow);">
                    <h2 style="text-align: center; margin-bottom: 40px;">–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–¥—Ö–æ–¥</h2>
                    <div class="grid grid-4">
                        <div style="text-align: center;">
                            <div style="width: 80px; height: 80px; background: var(--pink-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <i class="fas fa-list-alt" style="font-size: 2rem; color: white;"></i>
                            </div>
                            <h3 style="margin-bottom: 10px;">1. –í—ã–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏—é</h3>
                            <p style="color: var(--gray-600);">–î–æ–º –∏ –±—ã—Ç, –¥–µ—Ç–∏ –∏ —Å–µ–º—å—è, –∫—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ –∏ —Ç.–¥.</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 80px; height: 80px; background: var(--pink-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <i class="fas fa-lightbulb" style="font-size: 2rem; color: white;"></i>
                            </div>
                            <h3 style="margin-bottom: 10px;">2. –ü–æ–ª—É—á–∏—Ç–µ —à–ø–∞—Ä–≥–∞–ª–∫—É</h3>
                            <p style="color: var(--gray-600);">–ß—Ç–æ –æ–±—ã—á–Ω–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ç–∞–∫–æ–π –∑–∞–¥–∞—á–∏</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 80px; height: 80px; background: var(--pink-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <i class="fas fa-edit" style="font-size: 2rem; color: white;"></i>
                            </div>
                            <h3 style="margin-bottom: 10px;">3. –û–ø–∏—à–∏—Ç–µ –¥–µ—Ç–∞–ª–∏</h3>
                            <p style="color: var(--gray-600);">–° –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ —á—Ç–æ –Ω–µ –∑–∞–±—ã—Ç—å</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 80px; height: 80px; background: var(--pink-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                                <i class="fas fa-check-circle" style="font-size: 2rem; color: white;"></i>
                            </div>
                            <h3 style="margin-bottom: 10px;">4. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ</h3>
                            <p style="color: var(--gray-600);">–ß–∞—Ç —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º, —Å—Ç–∞—Ç—É—Å—ã, –æ—Ü–µ–Ω–∫–∞</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2: –ü–æ–¥–ø–∏—Å–∫–∏ -->
        <section id="page-subscriptions" class="page">
            <div class="container">
                <div style="padding: 40px 0;">
                    <h1 class="section-title" style="text-align: center; margin-bottom: 20px;">
                        –ü–æ–¥–ø–∏—Å–∫–∏ —Å –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–º –≤–∑–Ω–æ—Å–æ–º
                    </h1>
                    <p style="text-align: center; color: var(--gray-600); margin-bottom: 60px; max-width: 600px; margin-left: auto; margin-right: auto;">
                        –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π. –ï–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–π –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å + –µ–∂–µ–º–µ—Å—è—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞.
                    </p>
                    
                    <div class="grid grid-4" id="subscriptionsGrid">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                    
                    <!-- FAQ -->
                    <div style="margin-top: 80px;">
                        <h2 style="text-align: center; margin-bottom: 40px;">–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
                        <div class="grid grid-2" id="faqGrid">
                            <!-- FAQ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3: –õ–∏–Ω–∏–∏ –∑–∞–¥–∞—á -->
        <section id="page-services" class="page">
            <div class="container">
                <div style="padding: 40px 0;">
                    <h1 class="section-title" style="text-align: center; margin-bottom: 20px;">
                        –í—ã–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏—é –∑–∞–¥–∞—á–∏
                    </h1>
                    <p style="text-align: center; color: var(--gray-600); margin-bottom: 40px;">
                        –ë–æ–ª–µ–µ 6 –ª–∏–Ω–∏–π –∑–∞–¥–∞—á –¥–ª—è –≤–∞—à–µ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞
                    </p>
                    
                    <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
                    <div class="grid grid-3" id="categoriesGrid">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                    
                    <!-- –í–∏–∑–∞—Ä–¥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
                    <div class="wizard-container" id="taskWizard" style="display: none;">
                        <!-- –®–∞–≥ 1: –®–ø–∞—Ä–≥–∞–ª–∫–∞ -->
                        <div class="wizard-step active" id="wizardStep1">
                            <div class="wizard-header">
                                <h2 style="margin-bottom: 10px;" id="categoryTitle">–®–ø–∞—Ä–≥–∞–ª–∫–∞</h2>
                                <p id="categoryDescription" style="color: var(--gray-600);">–ß—Ç–æ –æ–±—ã—á–Ω–æ –Ω—É–∂–Ω–æ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</p>
                            </div>
                            
                            <div class="wizard-progress">
                                <div class="wizard-step-indicator active">
                                    <div class="wizard-step-circle">1</div>
                                    <div>–®–ø–∞—Ä–≥–∞–ª–∫–∞</div>
                                </div>
                                <div class="wizard-step-indicator">
                                    <div class="wizard-step-circle">2</div>
                                    <div>–ü–æ–¥—Å–∫–∞–∑–∫–∏</div>
                                </div>
                                <div class="wizard-step-indicator">
                                    <div class="wizard-step-circle">3</div>
                                    <div>–î–µ—Ç–∞–ª–∏</div>
                                </div>
                                <div class="wizard-step-indicator">
                                    <div class="wizard-step-circle">4</div>
                                    <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
                                </div>
                            </div>
                            
                            <div class="wizard-content">
                                <div id="cheatsheetContent">
                                    <!-- –®–ø–∞—Ä–≥–∞–ª–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </div>
                            </div>
                            
                            <div class="wizard-footer">
                                <button class="btn btn-secondary" onclick="cancelTaskWizard()">
                                    <i class="fas fa-times"></i>
                                    –û—Ç–º–µ–Ω–∞
                                </button>
                                <button class="btn btn-primary" onclick="nextWizardStep()">
                                    –î–∞–ª–µ–µ
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- –®–∞–≥ 2: –ü–æ–¥—Å–∫–∞–∑–∫–∏ -->
                        <div class="wizard-step" id="wizardStep2">
                            <div class="wizard-header">
                                <h2 style="margin-bottom: 10px;">–ß—Ç–æ –Ω–µ –∑–∞–±—ã—Ç—å –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞?</h2>
                                <p style="color: var(--gray-600);">–ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞—á–∏</p>
                            </div>
                            
                            <div class="wizard-progress">
                                <div class="wizard-step-indicator completed">
                                    <div class="wizard-step-circle"><i class="fas fa-check"></i></div>
                                    <div>–®–ø–∞—Ä–≥–∞–ª–∫–∞</div>
                                </div>
                                <div class="wizard-step-indicator active">
                                    <div class="wizard-step-circle">2</div>
                                    <div>–ü–æ–¥—Å–∫–∞–∑–∫–∏</div>
                                </div>
                                <div class="wizard-step-indicator">
                                    <div class="wizard-step-circle">3</div>
                                    <div>–î–µ—Ç–∞–ª–∏</div>
                                </div>
                                <div class="wizard-step-indicator">
                                    <div class="wizard-step-circle">4</div>
                                    <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
                                </div>
                            </div>
                            
                            <div class="wizard-content">
                                <div id="hintsContent">
                                    <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </div>
                            </div>
                            
                            <div class="wizard-footer">
                                <button class="btn btn-secondary" onclick="prevWizardStep()">
                                    <i class="fas fa-arrow-left"></i>
                                    –ù–∞–∑–∞–¥
                                </button>
                                <button class="btn btn-primary" onclick="nextWizardStep()">
                                    –î–∞–ª–µ–µ
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- –®–∞–≥ 3: –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏ -->
                        <div class="wizard-step" id="wizardStep3">
                            <div class="wizard-header">
                                <h2 style="margin-bottom: 10px;">–û–ø–∏—à–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏</h2>
                                <p style="color: var(--gray-600);">–ß–µ–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ, —Ç–µ–º –ª—É—á—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</p>
                            </div>
                            
                            <div class="wizard-progress">
                                <div class="wizard-step-indicator completed">
                                    <div class="wizard-step-circle"><i class="fas fa-check"></i></div>
                                    <div>–®–ø–∞—Ä–≥–∞–ª–∫–∞</div>
                                </div>
                                <div class="wizard-step-indicator completed">
                                    <div class="wizard-step-circle"><i class="fas fa-check"></i></div>
                                    <div>–ü–æ–¥—Å–∫–∞–∑–∫–∏</div>
                                </div>
                                <div class="wizard-step-indicator active">
                                    <div class="wizard-step-circle">3</div>
                                    <div>–î–µ—Ç–∞–ª–∏</div>
                                </div>
                                <div class="wizard-step-indicator">
                                    <div class="wizard-step-circle">4</div>
                                    <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
                                </div>
                            </div>
                            
                            <div class="wizard-content">
                                <form id="taskDetailsForm">
                                    <div style="margin-bottom: 20px;">
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                            –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *
                                        </label>
                                        <input type="text" id="wizardTaskTitle" 
                                               style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);"
                                               required placeholder="–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?">
                                    </div>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                            –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ *
                                        </label>
                                        <textarea id="wizardTaskDescription" 
                                                  style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius); min-height: 150px;"
                                                  required placeholder="–û–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ..."></textarea>
                                    </div>
                                    
                                    <div class="grid grid-2" style="gap: 20px; margin-bottom: 20px;">
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                                –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è *
                                            </label>
                                            <input type="datetime-local" id="wizardTaskDeadline" 
                                                   style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);"
                                                   required>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                                –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
                                            </label>
                                            <select id="wizardTaskPriority" 
                                                    style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);">
                                                <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                                <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                                <option value="low">–ù–∏–∑–∫–∏–π</option>
                                                <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                            –ê–¥—Ä–µ—Å *
                                        </label>
                                        <input type="text" id="wizardTaskAddress" 
                                               style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);"
                                               required placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞">
                                    </div>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                            –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è *
                                        </label>
                                        <input type="text" id="wizardTaskContact" 
                                               style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);"
                                               required placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏">
                                    </div>
                                    
                                    <div style="margin-bottom: 20px;">
                                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                                            –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
                                        </label>
                                        <textarea id="wizardTaskAdditional" 
                                                  style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius); min-height: 100px;"
                                                  placeholder="–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è, –∞–ª–ª–µ—Ä–≥–∏–∏, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è..."></textarea>
                                    </div>
                                </form>
                            </div>
                            
                            <div class="wizard-footer">
                                <button class="btn btn-secondary" onclick="prevWizardStep()">
                                    <i class="fas fa-arrow-left"></i>
                                    –ù–∞–∑–∞–¥
                                </button>
                                <button class="btn btn-primary" onclick="nextWizardStep()">
                                    –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
                                    <i class="fas fa-check"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- –®–∞–≥ 4: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -->
                        <div class="wizard-step" id="wizardStep4">
                            <div class="wizard-header">
                                <h2 style="margin-bottom: 10px;">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
                                <p style="color: var(--gray-600);">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π</p>
                            </div>
                            
                            <div class="wizard-progress">
                                <div class="wizard-step-indicator completed">
                                    <div class="wizard-step-circle"><i class="fas fa-check"></i></div>
                                    <div>–®–ø–∞—Ä–≥–∞–ª–∫–∞</div>
                                </div>
                                <div class="wizard-step-indicator completed">
                                    <div class="wizard-step-circle"><i class="fas fa-check"></i></div>
                                    <div>–ü–æ–¥—Å–∫–∞–∑–∫–∏</div>
                                </div>
                                <div class="wizard-step-indicator completed">
                                    <div class="wizard-step-circle"><i class="fas fa-check"></i></div>
                                    <div>–î–µ—Ç–∞–ª–∏</div>
                                </div>
                                <div class="wizard-step-indicator active">
                                    <div class="wizard-step-circle">4</div>
                                    <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
                                </div>
                            </div>
                            
                            <div class="wizard-content">
                                <div id="taskConfirmation">
                                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ -->
                                </div>
                            </div>
                            
                            <div class="wizard-footer">
                                <button class="btn btn-secondary" onclick="prevWizardStep()">
                                    <i class="fas fa-arrow-left"></i>
                                    –ù–∞–∑–∞–¥
                                </button>
                                <button class="btn btn-primary" onclick="createTaskFromWizard()">
                                    –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 4: –ú–æ–∏ –∑–∞–¥–∞—á–∏ -->
        <section id="page-tasks" class="page">
            <div class="container">
                <div style="padding: 40px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; flex-wrap: wrap; gap: 20px;">
                        <h1 class="section-title">–ú–æ–∏ –∑–∞–¥–∞—á–∏</h1>
                        <button class="btn btn-primary" onclick="navigate('services')">
                            <i class="fas fa-plus"></i>
                            –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞
                        </button>
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä—ã –∑–∞–¥–∞—á -->
                    <div style="margin-bottom: 30px; display: flex; gap: 15px; flex-wrap: wrap;">
                        <select class="btn btn-secondary" id="taskFilter" onchange="loadUserTasks()" style="padding: 12px 24px;">
                            <option value="all">–í—Å–µ –∑–∞–¥–∞—á–∏</option>
                            <option value="new">–ù–æ–≤—ã–µ</option>
                            <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                        </select>
                        
                        <select class="btn btn-secondary" id="taskSort" onchange="loadUserTasks()" style="padding: 12px 24px;">
                            <option value="newest">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                            <option value="oldest">–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</option>
                            <option value="deadline">–ü–æ —Å—Ä–æ–∫—É</option>
                        </select>
                    </div>
                    
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–¥–∞—á -->
                    <div class="grid grid-4" id="taskStats" style="margin-bottom: 40px;">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
                    <div id="tasksContainer">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 5: –ü—Ä–æ—Ñ–∏–ª—å -->
        <section id="page-profile" class="page">
            <div class="container">
                <div style="padding: 40px 0;">
                    <h1 class="section-title" style="text-align: center; margin-bottom: 40px;">
                        –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
                    </h1>
                    
                    <div class="grid grid-2" style="gap: 40px;">
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
                        <div class="card">
                            <h2 style="margin-bottom: 20px; color: var(--gray-900);">
                                <i class="fas fa-user-circle"></i>
                                –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                            </h2>
                            <div id="userInfo">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </div>
                        </div>
                        
                        <!-- –¢–µ–∫—É—â–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ -->
                        <div class="card">
                            <h2 style="margin-bottom: 20px; color: var(--gray-900);">
                                <i class="fas fa-crown"></i>
                                –ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞
                            </h2>
                            <div id="currentSubscription">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </div>
                            <button class="btn btn-primary" onclick="navigate('subscriptions')" style="margin-top: 20px;">
                                <i class="fas fa-sync-alt"></i>
                                –°–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
                            </button>
                        </div>
                        
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="card">
                            <h2 style="margin-bottom: 20px; color: var(--gray-900);">
                                <i class="fas fa-chart-line"></i>
                                –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            </h2>
                            <div id="userStats">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </div>
                        </div>
                        
                        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                        <div class="card">
                            <h2 style="margin-bottom: 20px; color: var(--gray-900);">
                                <i class="fas fa-bell"></i>
                                –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                            </h2>
                            <div id="notificationsList" style="max-height: 300px; overflow-y: auto;">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </div>
                            <button class="btn btn-secondary" onclick="markAllNotificationsRead()" style="margin-top: 20px;">
                                <i class="fas fa-check-double"></i>
                                –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 6: –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏ -->
        <section id="page-task-details" class="page">
            <div class="container">
                <div style="padding: 40px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; flex-wrap: wrap; gap: 20px;">
                        <h1 class="section-title" id="taskDetailsTitle">–î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏</h1>
                        <button class="btn btn-secondary" onclick="navigate('tasks')">
                            <i class="fas fa-arrow-left"></i>
                            –ù–∞–∑–∞–¥ –∫ –∑–∞–¥–∞—á–∞–º
                        </button>
                    </div>
                    
                    <div class="grid grid-3" style="gap: 30px;">
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ -->
                        <div class="card" style="grid-column: span 2;">
                            <div id="taskDetailsContent">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </div>
                            
                            <!-- –î–µ–π—Å—Ç–≤–∏—è —Å –∑–∞–¥–∞—á–µ–π -->
                            <div id="taskActions" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--gray-200);">
                                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                        </div>
                        
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ -->
                        <div class="card">
                            <h3 style="margin-bottom: 20px; color: var(--gray-900);">
                                <i class="fas fa-user-tie"></i>
                                –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
                            </h3>
                            <div id="performerInfo">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </div>
                        </div>
                        
                        <!-- –ß–∞—Ç –∑–∞–¥–∞—á–∏ -->
                        <div class="card" style="grid-column: span 3;">
                            <h3 style="margin-bottom: 20px; color: var(--gray-900);">
                                <i class="fas fa-comments"></i>
                                –ß–∞—Ç –∑–∞–¥–∞—á–∏
                            </h3>
                            <div id="taskChat">
                                <!-- –ß–∞—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>–ö–æ–Ω—Å—å–µ—Ä–∂ –°–µ—Ä–≤–∏—Å</h3>
                <p style="color: var(--gray-300); margin-bottom: 20px;">
                    –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é –±—ã—Ç–æ–≤—ã—Ö –∑–∞–¥–∞—á. –ö–∞—á–µ—Å—Ç–≤–æ, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞–±–æ—Ç–∞ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö.
                </p>
            </div>
            
            <div class="footer-section">
                <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h3>
                <ul class="footer-links">
                    <li><a href="#" onclick="navigate('home')"><i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="#" onclick="navigate('subscriptions')"><i class="fas fa-crown"></i> –ü–æ–¥–ø–∏—Å–∫–∏</a></li>
                    <li><a href="#" onclick="navigate('services')"><i class="fas fa-concierge-bell"></i> –õ–∏–Ω–∏–∏ –∑–∞–¥–∞—á</a></li>
                    <li><a href="#" onclick="navigate('tasks')"><i class="fas fa-tasks"></i> –ú–æ–∏ –∑–∞–¥–∞—á–∏</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                <ul class="footer-links">
                    <li><a href="tel:+79991234567"><i class="fas fa-phone"></i> +7 (999) 123-45-67</a></li>
                    <li><a href="mailto:info@concierge-service.ru"><i class="fas fa-envelope"></i> info@concierge-service.ru</a></li>
                    <li><a href="https://t.me/concierge_service" target="_blank"><i class="fab fa-telegram"></i> Telegram –∫–∞–Ω–∞–ª</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h3>
                <ul class="footer-links">
                    <li><a href="#" onclick="showModal('terms')"><i class="fas fa-file-contract"></i> –£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></li>
                    <li><a href="#" onclick="showModal('privacy')"><i class="fas fa-shield-alt"></i> –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
                    <li><a href="#" onclick="showModal('help')"><i class="fas fa-question-circle"></i> –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
                </ul>
            </div>
        </div>
        
        <div class="copyright">
            <p>¬© 2024 –ö–æ–Ω—Å—å–µ—Ä–∂ –°–µ—Ä–≤–∏—Å. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            <p style="margin-top: 10px;">–í–µ—Ä—Å–∏—è: <span id="appVersion">5.0.0</span></p>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    
    <!-- –†–µ–π—Ç–∏–Ω–≥ –∑–∞–¥–∞—á–∏ -->
    <div class="modal" id="rateTaskModal">
        <div class="modal-content">
            <div style="background: var(--pink-gradient); color: white; padding: 24px; border-radius: var(--radius-xl) var(--radius-xl) 0 0;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2 style="margin: 0;"><i class="fas fa-star"></i> –û—Ü–µ–Ω–∏—Ç–µ –∑–∞–¥–∞—á—É</h2>
                    <button onclick="closeModal('rateTaskModal')" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div style="padding: 24px;">
                <div style="text-align: center; margin-bottom: 30px;">
                    <p id="rateTaskTitle" style="font-size: 1.2rem; margin-bottom: 20px;"></p>
                    <div style="font-size: 2.5rem; color: var(--warning); margin-bottom: 20px;" id="ratingStars">
                        <i class="fas fa-star" onclick="setRating(1)" style="cursor: pointer; opacity: 0.3;"></i>
                        <i class="fas fa-star" onclick="setRating(2)" style="cursor: pointer; opacity: 0.3;"></i>
                        <i class="fas fa-star" onclick="setRating(3)" style="cursor: pointer; opacity: 0.3;"></i>
                        <i class="fas fa-star" onclick="setRating(4)" style="cursor: pointer; opacity: 0.3;"></i>
                        <i class="fas fa-star" onclick="setRating(5)" style="cursor: pointer; opacity: 0.3;"></i>
                    </div>
                    <div id="ratingText" style="color: var(--gray-600);">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–≤–µ–∑–¥—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏</div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">
                        –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                    </label>
                    <textarea id="ratingComment" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius); min-height: 100px;" placeholder="–ß—Ç–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –∏–ª–∏ —á—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å?"></textarea>
                </div>
                
                <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="ratingAnonymous" style="width: 20px; height: 20px;">
                    <label for="ratingAnonymous" style="color: var(--gray-700);">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –∞–Ω–æ–Ω–∏–º–Ω–æ</label>
                </div>
                
                <button class="btn btn-primary" onclick="submitRating()" style="width: 100%;">
                    <i class="fas fa-check"></i>
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É
                </button>
            </div>
        </div>
    </div>
    
    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–í—Ö–æ–¥ -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div style="background: var(--pink-gradient); color: white; padding: 24px; border-radius: var(--radius-xl) var(--radius-xl) 0 0;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2 style="margin: 0;" id="authModalTitle">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                    <button onclick="closeModal('authModal')" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div style="padding: 24px;">
                <div id="authLoginForm">
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">Email *</label>
                        <input type="email" id="loginEmail" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">–ü–∞—Ä–æ–ª—å *</label>
                        <input type="password" id="loginPassword" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required>
                    </div>
                    
                    <button class="btn btn-primary" onclick="login()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-sign-in-alt"></i>
                        –í–æ–π—Ç–∏
                    </button>
                    
                    <div style="text-align: center;">
                        <button class="btn btn-secondary" onclick="showRegisterForm()" style="width: 100%;">
                            <i class="fas fa-user-plus"></i>
                            –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                        </button>
                    </div>
                </div>
                
                <div id="authRegisterForm" style="display: none;">
                    <div class="grid grid-2" style="gap: 20px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">–ò–º—è *</label>
                            <input type="text" id="registerFirstName" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">–§–∞–º–∏–ª–∏—è *</label>
                            <input type="text" id="registerLastName" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">Email *</label>
                        <input type="email" id="registerEmail" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">–ü–∞—Ä–æ–ª—å *</label>
                        <input type="password" id="registerPassword" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel" id="registerPhone" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);" required placeholder="+7 (999) 123-45-67">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--gray-700);">–í—ã —Ö–æ—Ç–∏—Ç–µ:</label>
                        <select id="registerRole" style="width: 100%; padding: 12px; border: 2px solid var(--gray-200); border-radius: var(--radius);">
                            <option value="client">–ü–æ–ª—É—á–∞—Ç—å —É—Å–ª—É–≥–∏</option>
                            <option value="performer">–û–∫–∞–∑—ã–≤–∞—Ç—å —É—Å–ª—É–≥–∏</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="register()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-user-plus"></i>
                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                    
                    <div style="text-align: center;">
                        <button class="btn btn-secondary" onclick="showLoginForm()" style="width: 100%;">
                            <i class="fas fa-arrow-left"></i>
                            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—Ö–æ–¥—É
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notificationContainer"></div>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
    <div class="modal" id="loadingModal">
        <div class="modal-content" style="background: transparent; box-shadow: none; max-width: 200px;">
            <div class="loading">
                <div class="spinner"></div>
                <p style="color: white; margin-top: 15px;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = null;
        let currentToken = localStorage.getItem('token');
        let currentPage = 'home';
        let currentTaskId = null;
        let currentCategoryId = null;
        let currentRating = 0;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤–∏–∑–∞—Ä–¥–∞
        let wizardCurrentStep = 1;
        let wizardTaskData = {};
        
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            loadHomePage();
            setupEventListeners();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            if (currentToken) {
                verifyToken();
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –¥–ª—è –¥–µ–¥–ª–∞–π–Ω–∞ (–∑–∞–≤—Ç—Ä–∞, —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è + 1 —á–∞—Å)
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(18, 0, 0, 0);
            
            const formattedDate = tomorrow.toISOString().slice(0, 16);
            document.getElementById('wizardTaskDeadline').min = new Date().toISOString().slice(0, 16);
            document.getElementById('wizardTaskDeadline').value = formattedDate;
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            console.log('üéÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ö–æ–Ω—Å—å–µ—Ä–∂ –°–µ—Ä–≤–∏—Å–∞ v5.0.0...');
            updateUserMenu();
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function navigate(page) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            const targetPage = document.getElementById(`page-${page}`);
            if (targetPage) {
                targetPage.classList.add('active');
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Å—ã–ª–∫—É
                document.querySelectorAll('.nav-link').forEach(link => {
                    if (link.textContent.includes(getPageTitle(page))) {
                        link.classList.add('active');
                    }
                });
                
                currentPage = page;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                switch(page) {
                    case 'home':
                        loadHomePage();
                        break;
                    case 'subscriptions':
                        loadSubscriptionsPage();
                        break;
                    case 'services':
                        loadServicesPage();
                        break;
                    case 'tasks':
                        loadTasksPage();
                        break;
                    case 'profile':
                        loadProfilePage();
                        break;
                    case 'task-details':
                        loadTaskDetailsPage();
                        break;
                }
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
                closeMobileMenu();
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –Ω–∞–≤–µ—Ä—Ö
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
        
        function getPageTitle(page) {
            const titles = {
                'home': '–ì–ª–∞–≤–Ω–∞—è',
                'subscriptions': '–ü–æ–¥–ø–∏—Å–∫–∏',
                'services': '–õ–∏–Ω–∏–∏ –∑–∞–¥–∞—á',
                'tasks': '–ú–æ–∏ –∑–∞–¥–∞—á–∏',
                'profile': '–ü—Ä–æ—Ñ–∏–ª—å',
                'task-details': '–î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∏'
            };
            return titles[page] || page;
        }
        
        // –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
        function toggleMobileMenu() {
            const menu = document.getElementById('navMenu');
            menu.classList.toggle('active');
        }
        
        function closeMobileMenu() {
            const menu = document.getElementById('navMenu');
            menu.classList.remove('active');
        }
        
        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        function openAuthModal() {
            showLoginForm();
            showModal('authModal');
        }
        
        function showLoginForm() {
            document.getElementById('authLoginForm').style.display = 'block';
            document.getElementById('authRegisterForm').style.display = 'none';
            document.getElementById('authModalTitle').textContent = '–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É';
        }
        
        function showRegisterForm() {
            document.getElementById('authLoginForm').style.display = 'none';
            document.getElementById('authRegisterForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
        }
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞
        function showLoading() {
            showModal('loadingModal');
        }
        
        function hideLoading() {
            closeModal('loadingModal');
        }
        
        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –º–µ–Ω—é
        function updateUserMenu() {
            const userMenu = document.getElementById('userMenu');
            
            if (currentUser) {
                userMenu.innerHTML = `
                    <div class="user-avatar" onclick="navigate('profile')">
                        ${currentUser.firstName ? currentUser.firstName[0] : 'U'}
                    </div>
                    <button class="btn btn-secondary" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        –í—ã–π—Ç–∏
                    </button>
                `;
            } else {
                userMenu.innerHTML = `
                    <button class="btn btn-primary" onclick="openAuthModal()">
                        <i class="fas fa-user"></i>
                        –í–æ–π—Ç–∏
                    </button>
                `;
            }
        }
        
        // ==================== –°–¢–†–ê–ù–ò–¶–´ ====================
        
        // –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        async function loadHomePage() {
            // –¢–æ–ø —É—Å–ª—É–≥–∏
            await loadTopServices();
            
            // –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            await loadPopularCategories();
        }
        
        async function loadTopServices() {
            try {
                const response = await fetch('/api/categories/top-services');
                const data = await response.json();
                
                if (data.success) {
                    const topServicesGrid = document.getElementById('topServicesGrid');
                    const topServicesTitle = document.getElementById('topServicesTitle');
                    
                    topServicesTitle.textContent = data.data.title;
                    
                    if (data.data.services.length === 0) {
                        topServicesGrid.innerHTML = `
                            <div class="empty-state" style="grid-column: 1 / -1;">
                                <i class="fas fa-star"></i>
                                <p>–¢–æ–ø —É—Å–ª—É–≥–∏ —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è</p>
                            </div>
                        `;
                        return;
                    }
                    
                    topServicesGrid.innerHTML = data.data.services.map(service => `
                        <div class="top-service-card" onclick="startTaskFromTopService(${service.category_id}, '${service.name}')">
                            <div style="display: flex; align-items: flex-start; gap: 15px;">
                                <div style="font-size: 1.5rem;">${service.category_icon}</div>
                                <div>
                                    <div class="top-service-title">${service.name}</div>
                                    <div class="top-service-description">${service.description}</div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–ø —É—Å–ª—É–≥:', error);
            }
        }
        
        async function loadPopularCategories() {
            try {
                const response = await fetch('/api/categories');
                const data = await response.json();
                
                if (data.success) {
                    const popularCategories = document.getElementById('popularCategories');
                    
                    // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    const categories = data.data.categories.slice(0, 3);
                    
                    popularCategories.innerHTML = categories.map(category => `
                        <div class="category-card" onclick="startTaskWizard(${category.id})">
                            <div class="category-icon">${category.icon}</div>
                            <div class="category-title">${category.display_name}</div>
                            <div class="category-description">${category.description}</div>
                            <button class="btn btn-primary" style="margin-top: 15px;">
                                –í—ã–±—Ä–∞—Ç—å –ª–∏–Ω–∏—é
                            </button>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
            }
        }
        
        // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥–ø–∏—Å–æ–∫
        async function loadSubscriptionsPage() {
            try {
                const response = await fetch('/api/subscriptions');
                const data = await response.json();
                
                if (data.success) {
                    const subscriptionsGrid = document.getElementById('subscriptionsGrid');
                    
                    subscriptionsGrid.innerHTML = data.data.subscriptions.map(sub => {
                        const isPopular = sub.name === 'basic';
                        const userHasThisPlan = currentUser && currentUser.subscription_plan === sub.name;
                        const userHasPaidFee = currentUser && currentUser.initial_fee_paid;
                        const requiresFee = sub.initial_fee > 0 && !userHasPaidFee;
                        
                        return `
                            <div class="card" ${isPopular ? 'style="border: 3px solid var(--pink-primary); transform: scale(1.05);"' : ''}>
                                <div style="text-align: center; padding: 30px 20px;">
                                    ${isPopular ? '<span class="badge badge-success" style="position: absolute; top: 20px; right: 20px;">–ü–æ–ø—É–ª—è—Ä–Ω–æ</span>' : ''}
                                    <div style="font-size: 2rem; margin-bottom: 15px;">${sub.name === 'free' ? 'üéÅ' : sub.name === 'basic' ? '‚≠ê' : sub.name === 'premium' ? 'üëë' : 'üè¢'}</div>
                                    <h3 style="margin-bottom: 10px; ${isPopular ? 'color: var(--pink-primary);' : ''}">${sub.display_name}</h3>
                                    <p style="color: var(--gray-600); margin-bottom: 25px;">${sub.description}</p>
                                    
                                    <div style="text-align: center; margin: 30px 0;">
                                        ${requiresFee ? `
                                            <div style="margin-bottom: 15px;">
                                                <div style="font-size: 1rem; color: var(--gray-500);">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å</div>
                                                <div style="font-size: 1.8rem; font-weight: 800; color: var(--warning);">${sub.initial_fee}‚ÇΩ</div>
                                            </div>
                                        ` : ''}
                                        
                                        <div>
                                            <div style="font-size: ${requiresFee ? '1.8rem' : '2.5rem'}; font-weight: 800; color: var(--gray-900);">${sub.price_monthly}‚ÇΩ</div>
                                            <div style="color: var(--gray-500);">–≤ –º–µ—Å—è—Ü</div>
                                        </div>
                                    </div>
                                    
                                    <ul style="list-style: none; margin-bottom: 30px; text-align: left;">
                                        ${sub.features.slice(0, 4).map(feature => `
                                            <li style="margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                                                <i class="fas fa-check" style="color: var(--success);"></i>
                                                <span>${feature}</span>
                                            </li>
                                        `).join('')}
                                    </ul>
                                    
                                    ${userHasThisPlan ? `
                                        <div style="background: var(--success); color: white; padding: 10px; border-radius: var(--radius); margin-bottom: 20px;">
                                            <i class="fas fa-check-circle"></i> –í–∞—à —Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω
                                        </div>
                                    ` : ''}
                                    
                                    <button class="btn ${userHasThisPlan ? 'btn-secondary' : isPopular ? 'btn-primary' : 'btn-secondary'}" 
                                            onclick="${currentToken ? `subscribeToPlan('${sub.name}')` : 'openAuthModal()'}" 
                                            style="width: 100%;">
                                        ${currentToken ? (userHasThisPlan ? '–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω' : (requiresFee ? `–û–ø–ª–∞—Ç–∏—Ç—å ${sub.initial_fee}‚ÇΩ` : '–í—ã–±—Ä–∞—Ç—å')) : '–í–æ–π—Ç–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞'}
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫:', error);
            }
            
            // FAQ
            const faqGrid = document.getElementById('faqGrid');
            faqGrid.innerHTML = `
                <div class="card">
                    <h4 style="margin-bottom: 10px;">–ß—Ç–æ —Ç–∞–∫–æ–µ –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å?</h4>
                    <p style="color: var(--gray-600);">–ï–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–¥–ø–∏—Å–∫–µ. –ì–∞—Ä–∞–Ω—Ç–∏—è —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–∏—Å—É.</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 10px;">–ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?</h4>
                    <p style="color: var(--gray-600);">–î–∞, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 10px;">–ß—Ç–æ –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤—Å–µ –∑–∞–¥–∞—á–∏?</h4>
                    <p style="color: var(--gray-600);">–ù–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü.</p>
                </div>
                <div class="card">
                    <h4 style="margin-bottom: 10px;">–ï—Å—Ç—å –ª–∏ –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥?</h4>
                    <p style="color: var(--gray-600);">–î–∞, –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç 1 –∑–∞–¥–∞—á—É –≤ –º–µ—Å—è—Ü –Ω–∞–≤—Å–µ–≥–¥–∞!</p>
                </div>
            `;
        }
        
        // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–∏–Ω–∏–π –∑–∞–¥–∞—á
        async function loadServicesPage() {
            try {
                const response = await fetch('/api/categories');
                const data = await response.json();
                
                if (data.success) {
                    const categoriesGrid = document.getElementById('categoriesGrid');
                    
                    categoriesGrid.innerHTML = data.data.categories.map(category => `
                        <div class="category-card" onclick="startTaskWizard(${category.id})">
                            <div class="category-icon">${category.icon}</div>
                            <div class="category-title">${category.display_name}</div>
                            <div class="category-description">${category.description}</div>
                            <button class="btn btn-primary" style="margin-top: 15px;">
                                –ù–∞—á–∞—Ç—å –∑–∞–¥–∞—á—É
                            </button>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –≤–∏–∑–∞—Ä–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
        async function startTaskWizard(categoryId) {
            if (!currentToken) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                openAuthModal();
                return;
            }
            
            currentCategoryId = categoryId;
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–∑–∞—Ä–¥
            document.getElementById('categoriesGrid').style.display = 'none';
            document.getElementById('taskWizard').style.display = 'block';
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞
            await loadCheatsheetForCategory(categoryId);
        }
        
        async function startTaskFromTopService(categoryId, serviceName) {
            if (!currentToken) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                openAuthModal();
                return;
            }
            
            currentCategoryId = categoryId;
            wizardTaskData.presetTitle = serviceName;
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–∑–∞—Ä–¥
            document.getElementById('categoriesGrid').style.display = 'none';
            document.getElementById('taskWizard').style.display = 'block';
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞
            await loadCheatsheetForCategory(categoryId);
        }
        
        async function loadCheatsheetForCategory(categoryId) {
            try {
                const response = await fetch(`/api/categories/cheatsheet?category_id=${categoryId}`);
                const data = await response.json();
                
                if (data.success) {
                    const cheatsheetContent = document.getElementById('cheatsheetContent');
                    const categoryTitle = document.getElementById('categoryTitle');
                    const categoryDescription = document.getElementById('categoryDescription');
                    
                    categoryTitle.textContent = data.data.cheatsheets[0]?.category_name || '–®–ø–∞—Ä–≥–∞–ª–∫–∞';
                    categoryDescription.textContent = '–ß—Ç–æ –æ–±—ã—á–Ω–æ –Ω—É–∂–Ω–æ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏';
                    
                    cheatsheetContent.innerHTML = data.data.cheatsheets.map(sheet => `
                        <div class="cheatsheet-card">
                            <div class="cheatsheet-title">${sheet.title}</div>
                            <div class="cheatsheet-content">${sheet.content}</div>
                        </div>
                    `).join('');
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    wizardTaskData.categoryId = categoryId;
                    wizardTaskData.categoryName = data.data.cheatsheets[0]?.category_name || '';
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —à–∞–≥ –≤–∏–∑–∞—Ä–¥–∞
                    wizardCurrentStep = 1;
                    showWizardStep(1);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–ø–∞—Ä–≥–∞–ª–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–ø–∞—Ä–≥–∞–ª–∫–∏', 'error');
                cancelTaskWizard();
            }
        }
        
        async function loadHintsForCategory(categoryId) {
            try {
                const response = await fetch(`/api/categories/hints?category_id=${categoryId}`);
                const data = await response.json();
                
                if (data.success) {
                    const hintsContent = document.getElementById('hintsContent');
                    
                    if (data.data.hints.length === 0) {
                        hintsContent.innerHTML = `
                            <div style="text-align: center; padding: 40px 20px;">
                                <i class="fas fa-lightbulb" style="font-size: 3rem; color: var(--gray-300); margin-bottom: 20px;"></i>
                                <p style="color: var(--gray-600);">–ù–µ—Ç –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</p>
                            </div>
                        `;
                        return;
                    }
                    
                    // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —à–∞–≥–∞–º
                    const steps = {};
                    data.data.hints.forEach(hint => {
                        if (!steps[hint.step_number]) {
                            steps[hint.step_number] = [];
                        }
                        steps[hint.step_number].push(hint);
                    });
                    
                    let hintsHtml = '';
                    Object.keys(steps).sort().forEach(stepNumber => {
                        const stepHints = steps[stepNumber];
                        hintsHtml += `
                            <div style="margin-bottom: 30px;">
                                <h3 style="margin-bottom: 15px; color: var(--pink-primary);">–®–∞–≥ ${stepNumber}</h3>
                                ${stepHints.map(hint => `
                                    <div class="hint-card">
                                        <div class="hint-title">${hint.title}</div>
                                        <div class="hint-content">${hint.content}</div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    });
                    
                    hintsContent.innerHTML = hintsHtml;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥—Å–∫–∞–∑–æ–∫:', error);
            }
        }
        
        function showWizardStep(step) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —à–∞–≥–∏
            document.querySelectorAll('.wizard-step').forEach(stepEl => {
                stepEl.classList.remove('active');
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
            document.querySelectorAll('.wizard-step-indicator').forEach(indicator => {
                indicator.classList.remove('active', 'completed');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —à–∞–≥
            document.getElementById(`wizardStep${step}`).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
            for (let i = 1; i <= 4; i++) {
                const indicator = document.querySelector(`.wizard-step-indicator:nth-child(${i})`);
                if (i < step) {
                    indicator.classList.add('completed');
                } else if (i === step) {
                    indicator.classList.add('active');
                }
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —à–∞–≥–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (step === 2 && currentCategoryId) {
                loadHintsForCategory(currentCategoryId);
            } else if (step === 3) {
                // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
                if (wizardTaskData.presetTitle) {
                    document.getElementById('wizardTaskTitle').value = wizardTaskData.presetTitle;
                }
            } else if (step === 4) {
                showTaskConfirmation();
            }
        }
        
        function nextWizardStep() {
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
            if (wizardCurrentStep === 3) {
                const form = document.getElementById('taskDetailsForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
                wizardTaskData.title = document.getElementById('wizardTaskTitle').value;
                wizardTaskData.description = document.getElementById('wizardTaskDescription').value;
                wizardTaskData.deadline = document.getElementById('wizardTaskDeadline').value;
                wizardTaskData.priority = document.getElementById('wizardTaskPriority').value;
                wizardTaskData.address = document.getElementById('wizardTaskAddress').value;
                wizardTaskData.contact = document.getElementById('wizardTaskContact').value;
                wizardTaskData.additional = document.getElementById('wizardTaskAdditional').value;
            }
            
            if (wizardCurrentStep < 4) {
                wizardCurrentStep++;
                showWizardStep(wizardCurrentStep);
            }
        }
        
        function prevWizardStep() {
            if (wizardCurrentStep > 1) {
                wizardCurrentStep--;
                showWizardStep(wizardCurrentStep);
            }
        }
        
        function cancelTaskWizard() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            currentCategoryId = null;
            wizardCurrentStep = 1;
            wizardTaskData = {};
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Å–∫—Ä—ã–≤–∞–µ–º –≤–∏–∑–∞—Ä–¥
            document.getElementById('categoriesGrid').style.display = 'grid';
            document.getElementById('taskWizard').style.display = 'none';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('taskDetailsForm').reset();
        }
        
        function showTaskConfirmation() {
            const confirmationDiv = document.getElementById('taskConfirmation');
            
            confirmationDiv.innerHTML = `
                <div style="background: var(--light-bg); border-radius: var(--radius); padding: 25px; margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--gray-900);">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong>
                            <div>${wizardTaskData.categoryName}</div>
                        </div>
                        <div>
                            <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</strong>
                            <div>${getPriorityText(wizardTaskData.priority)}</div>
                        </div>
                        <div>
                            <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–ù–∞–∑–≤–∞–Ω–∏–µ:</strong>
                            <div>${wizardTaskData.title}</div>
                        </div>
                        <div>
                            <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–°—Ä–æ–∫:</strong>
                            <div>${new Date(wizardTaskData.deadline).toLocaleString('ru-RU')}</div>
                        </div>
                        <div style="grid-column: 1 / -1;">
                            <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–û–ø–∏—Å–∞–Ω–∏–µ:</strong>
                            <div>${wizardTaskData.description}</div>
                        </div>
                        <div style="grid-column: 1 / -1;">
                            <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–ê–¥—Ä–µ—Å:</strong>
                            <div>${wizardTaskData.address}</div>
                        </div>
                        ${wizardTaskData.additional ? `
                            <div style="grid-column: 1 / -1;">
                                <strong style="color: var(--gray-500); display: block; margin-bottom: 5px;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:</strong>
                                <div>${wizardTaskData.additional}</div>
                            </div>
                        ` : ''}
                    </div>
                </div>
                
                <div style="background: #F0F9FF; border-radius: var(--radius); padding: 20px; border-left: 4px solid var(--info);">
                    <h4 style="margin-bottom: 10px; color: var(--gray-900);">
                        <i class="fas fa-info-circle"></i> –ß—Ç–æ –±—É–¥–µ—Ç –¥–∞–ª—å—à–µ?
                    </h4>
                    <p style="color: var(--gray-600); margin-bottom: 15px;">
                        1. –ó–∞–¥–∞—á–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ú–æ–∏ –∑–∞–¥–∞—á–∏"<br>
                        2. –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π<br>
                        3. –ù–∞–∑–Ω–∞—á–∏—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∏ —Å–æ–≥–ª–∞—Å—É–µ—Ç —Å—Ä–æ–∫–∏<br>
                        4. –í—ã —Å–º–æ–∂–µ—Ç–µ –æ–±—â–∞—Ç—å—Å—è –≤ —á–∞—Ç–µ –∑–∞–¥–∞—á–∏<br>
                        5. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã
                    </p>
                </div>
            `;
        }
        
        function getPriorityText(priority) {
            const priorities = {
                'low': '–ù–∏–∑–∫–∏–π',
                'medium': '–°—Ä–µ–¥–Ω–∏–π',
                'high': '–í—ã—Å–æ–∫–∏–π',
                'urgent': '–°—Ä–æ—á–Ω—ã–π'
            };
            return priorities[priority] || '–°—Ä–µ–¥–Ω–∏–π';
        }
        
        async function createTaskFromWizard() {
            showLoading();
            
            try {
                const response = await fetch('/api/tasks', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({
                        title: wizardTaskData.title,
                        description: wizardTaskData.description,
                        category_id: wizardTaskData.categoryId,
                        priority: wizardTaskData.priority,
                        deadline: wizardTaskData.deadline,
                        address: wizardTaskData.address,
                        contact_info: wizardTaskData.contact,
                        additional_requirements: wizardTaskData.additional
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞! –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏.', 'success');
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤–∏–∑–∞—Ä–¥
                    cancelTaskWizard();
                    
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–¥–∞—á
                    navigate('tasks');
                    
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadTasksPage() {
            if (!currentToken) {
                const tasksContainer = document.getElementById('tasksContainer');
                tasksContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tasks"></i>
                        <h3 style="margin-bottom: 15px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á</h3>
                        <p style="margin-bottom: 25px;">–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–¥–∞—á–∏</p>
                        <button class="btn btn-primary" onclick="openAuthModal()">
                            <i class="fas fa-sign-in-alt"></i>
                            –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
                        </button>
                    </div>
                `;
                return;
            }
            
            showLoading();
            
            try {
                const filter = document.getElementById('taskFilter').value;
                const sort = document.getElementById('taskSort').value;
                
                let url = `/api/tasks?limit=50`;
                if (filter !== 'all') url += `&status=${filter}`;
                
                if (sort === 'oldest') url += `&sort=created_at&order=ASC`;
                else if (sort === 'deadline') url += `&sort=deadline&order=ASC`;
                
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${currentToken}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const tasks = data.data.tasks;
                    const pagination = data.data.pagination;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    updateTaskStats(tasks);
                    
                    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
                    const tasksContainer = document.getElementById('tasksContainer');
                    
                    if (tasks.length === 0) {
                        tasksContainer.innerHTML = `
                            <div class="empty-state">
                                <i class="fas fa-tasks"></i>
                                <h3 style="margin-bottom: 15px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á</h3>
                                <p style="margin-bottom: 25px;">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ –ª–∏–Ω–∏–∏ –∑–∞–¥–∞—á</p>
                                <button class="btn btn-primary" onclick="navigate('services')">
                                    <i class="fas fa-plus-circle"></i>
                                    –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É
                                </button>
                            </div>
                        `;
                    } else {
                        let tasksHtml = '<div class="grid" style="gap: 20px;">';
                        
                        tasks.forEach(task => {
                            const statusClass = `status-${task.status}`;
                            const statusText = task.status_info?.label || task.status;
                            
                            const deadlineDate = new Date(task.deadline);
                            const now = new Date();
                            const daysDiff = Math.ceil((deadlineDate - now) / (1000 * 60 * 60 * 24));
                            
                            let deadlineText = '';
                            if (daysDiff < 0) {
                                deadlineText = `<span style="color: var(--danger);">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ –Ω–∞ ${Math.abs(daysDiff)} –¥–Ω.</span>`;
                            } else if (daysDiff === 0) {
                                deadlineText = '<span style="color: var(--warning);">–°–µ–≥–æ–¥–Ω—è</span>';
                            } else if (daysDiff === 1) {
                                deadlineText = '<span style="color: var(--warning);">–ó–∞–≤—Ç—Ä–∞</span>';
                            } else if (daysDiff <= 7) {
                                deadlineText = `–ß–µ—Ä–µ–∑ ${daysDiff} –¥–Ω.`;
                            } else {
                                deadlineText = new Date(task.deadline).toLocaleDateString('ru-RU');
                            }
                            
                            tasksHtml += `
                                <div class="card" onclick="viewTaskDetails(${task.id})" style="cursor: pointer; transition: var(--transition);">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 10px; color: var(--gray-900);">${task.title}</h3>
                                            <div style="display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;">
                                                <span class="task-status ${statusClass}">
                                                    ${task.status_info?.icon || ''} ${statusText}
                                                </span>
                                                <span class="badge" style="background: ${task.priority_info?.color || '#95A5A6'}; color: white;">
                                                    ${task.priority_info?.label || '–°—Ä–µ–¥–Ω–∏–π'}
                                                </span>
                                            </div>
                                        </div>
                                        <div style="font-size: 2.5rem; color: var(--pink-light);">
                                            ${task.category_icon || 'üìù'}
                                        </div>
                                    </div>
                                    
                                    <p style="color: var(--gray-600); margin-bottom: 15px; font-size: 0.95rem;">
                                        ${task.description.length > 150 ? task.description.substring(0, 150) + '...' : task.description}
                                    </p>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-size: 0.9rem; color: var(--gray-500);">
                                        <div>
                                            <i class="fas fa-tag"></i> ${task.category_name || ''}
                                        </div>
                                        <div>
                                            <i class="fas fa-calendar-alt"></i> ${deadlineText}
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 15px; border-top: 1px solid var(--gray-200);">
                                        <div style="font-size: 0.9rem; color: var(--gray-500);">
                                            ‚Ññ ${task.task_number || task.id}
                                        </div>
                                        <div style="display: flex; gap: 10px;">
                                            ${task.can_chat ? `
                                                <button class="btn btn-secondary" onclick="viewTaskChat(${task.id}); event.stopPropagation();" style="padding: 6px 12px; font-size: 0.8rem;">
                                                    <i class="fas fa-comment"></i>
                                                </button>
                                            ` : ''}
                                            <button class="btn btn-primary" onclick="viewTaskDetails(${task.id}); event.stopPropagation();" style="padding: 6px 12px; font-size: 0.8rem;">
                                                <i class="fas fa-eye"></i> –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                        
                        tasksHtml += '</div>';
                        tasksContainer.innerHTML = tasksHtml;
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á', 'error');
            } finally {
                hideLoading();
            }
        }
        
        function updateTaskStats(tasks) {
            const taskStats = document.getElementById('taskStats');
            
            const totalTasks = tasks.length;
            const newTasks = tasks.filter(t => t.status === 'new').length;
            const inProgressTasks = tasks.filter(t => t.status === 'in_progress').length;
            const completedTasks = tasks.filter(t => t.status === 'completed').length;
            
            taskStats.innerHTML = `
                <div class="card">
                    <h3 style="color: var(--gray-500); margin-bottom: 10px;">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</h3>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--pink-primary);">${totalTasks}</div>
                </div>
                <div class="card">
                    <h3 style="color: var(--gray-500); margin-bottom: 10px;">–ù–æ–≤—ã–µ</h3>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--info);">${newTasks}</div>
                </div>
                <div class="card">
                    <h3 style="color: var(--gray-500); margin-bottom: 10px;">–í —Ä–∞–±–æ—Ç–µ</h3>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--warning);">${inProgressTasks}</div>
                </div>
                <div class="card">
                    <h3 style="color: var(--gray-500); margin-bottom: 10px;">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</h3>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--success);">${completedTasks}</div>
                </div>
            `;
        }
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –∑–∞–¥–∞—á–∏
        function viewTaskDetails(taskId) {
            currentTaskId = taskId;
            navigate('task-details');
        }
        
        async function loadTaskDetailsPage() {
            if (!currentTaskId) {
                navigate('tasks');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(`/api/tasks/${currentTaskId}`, {
                    headers: {
                        'Authorization': `Bearer ${currentToken}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const task = data.data.task;
                    
                    // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                    document.getElementById('taskDetailsTitle').textContent = task.title;
                    
                    // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                    const taskDetailsContent = document.getElementById('taskDetailsContent');
                    const statusClass = `status-${task.status}`;
                    const statusText = task.status_info?.label || task.status;
                    
                    taskDetailsContent.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; flex-wrap: wrap; gap: 20px;">
                            <div>
                                <h2 style="margin-bottom: 10px; color: var(--gray-900);">${task.title}</h2>
                                <div style="display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap;">
                                    <span class="task-status ${statusClass}" style="font-size: 0.9rem;">
                                        ${task.status_info?.icon || ''} ${statusText}
                                    </span>
                                    <span class="badge" style="background: ${task.priority_info?.color || '#95A5A6'}; color: white;">
                                        ${task.priority_info?.label || '–°—Ä–µ–¥–Ω–∏–π'}
                                    </span>
                                    <span class="badge" style="background: var(--pink-light); color: var(--pink-primary);">
                                        <i class="fas fa-tag"></i> ${task.category_name || ''}
                                    </span>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 0.9rem; color: var(--gray-500); margin-bottom: 5px;">–ù–æ–º–µ—Ä –∑–∞–¥–∞—á–∏</div>
                                <div style="font-weight: 600; color: var(--pink-primary);">${task.task_number || task.id}</div>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                            <div>
                                <h4 style="margin-bottom: 15px; color: var(--gray-900);">
                                    <i class="fas fa-info-circle"></i> –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
                                </h4>
                                <p style="color: var(--gray-700); line-height: 1.6; white-space: pre-wrap;">${task.description}</p>
                                
                                ${task.additional_requirements ? `
                                    <div style="margin-top: 20px;">
                                        <h5 style="margin-bottom: 10px; color: var(--gray-900);">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:</h5>
                                        <p style="color: var(--gray-700); line-height: 1.6; white-space: pre-wrap;">${task.additional_requirements}</p>
                                    </div>
                                ` : ''}
                            </div>
                            
                            <div>
                                <h4 style="margin-bottom: 15px; color: var(--gray-900);">
                                    <i class="fas fa-map-marker-alt"></i> –î–µ—Ç–∞–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                                </h4>
                                
                                <div style="background: var(--gray-50); border-radius: var(--radius); padding: 20px; margin-bottom: 20px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                        <i class="fas fa-calendar" style="color: var(--pink-primary);"></i>
                                        <div>
                                            <div style="font-size: 0.9rem; color: var(--gray-500);">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</div>
                                            <div style="font-weight: 600; color: var(--gray-900);">
                                                ${new Date(task.deadline).toLocaleString('ru-RU')}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                        <i class="fas fa-home" style="color: var(--pink-primary);"></i>
                                        <div>
                                            <div style="font-size: 0.9rem; color: var(--gray-500);">–ê–¥—Ä–µ—Å</div>
                                            <div style="font-weight: 600; color: var(--gray-900);">${task.address}</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-phone" style="color: var(--pink-primary);"></i>
                                        <div>
                                            <div style="font-size: 0.9rem; color: var(--gray-500);">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
                                            <div style="font-weight: 600; color: var(--gray-900);">${task.contact_info}</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="background: var(--light-bg); border-radius: var(--radius); padding: 20px;">
                                    <h5 style="margin-bottom: 10px; color: var(--gray-900);">–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤</h5>
                                    ${task.status_history && task.status_history.length > 0 ? `
                                        <div style="display: flex; flex-direction: column; gap: 10px;">
                                            ${task.status_history.slice(-3).reverse().map(status => `
                                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: var(--radius-sm);">
                                                    <div>
                                                        <div style="font-weight: 600; color: var(--gray-900);">${status.status}</div>
                                                        <div style="font-size: 0.8rem; color: var(--gray-500);">${status.firstName} ${status.lastName}</div>
                                                    </div>
                                                    <div style="font-size: 0.8rem; color: var(--gray-500);">
                                                        ${new Date(status.created_at).toLocaleString('ru-RU', {hour12: false})}
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    ` : '<p style="color: var(--gray-500); font-style: italic;">–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤</p>'}
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ
                    const performerInfo = document.getElementById('performerInfo');
                    if (task.performer_firstName) {
                        performerInfo.innerHTML = `
                            <div style="text-align: center; padding: 20px;">
                                <div style="width: 80px; height: 80px; background: var(--pink-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem; font-weight: 600;">
                                    ${task.performer_firstName[0]}${task.performer_lastName[0]}
                                </div>
                                <h4 style="margin-bottom: 5px; color: var(--gray-900);">
                                    ${task.performer_firstName} ${task.performer_lastName}
                                </h4>
                                <p style="color: var(--gray-500); margin-bottom: 15px;">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</p>
                                ${task.performer_phone ? `
                                    <div style="margin-bottom: 15px;">
                                        <i class="fas fa-phone" style="margin-right: 8px; color: var(--pink-primary);"></i>
                                        <span>${task.performer_phone}</span>
                                    </div>
                                ` : ''}
                                <button class="btn btn-primary" onclick="openTaskChat()" style="width: 100%;">
                                    <i class="fas fa-comment"></i>
                                    –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
                                </button>
                            </div>
                        `;
                    } else {
                        performerInfo.innerHTML = `
                            <div style="text-align: center; padding: 40px 20px;">
                                <i class="fas fa-user-clock" style="font-size: 3rem; color: var(--gray-300); margin-bottom: 20px;"></i>
                                <p style="color: var(--gray-600); margin-bottom: 15px;">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</p>
                                <p style="color: var(--gray-500); font-size: 0.9rem;">
                                    –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–∫–æ—Ä–æ –Ω–∞–π–¥–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
                                </p>
                            </div>
                        `;
                    }
                    
                    // –î–µ–π—Å—Ç–≤–∏—è —Å –∑–∞–¥–∞—á–µ–π
                    const taskActions = document.getElementById('taskActions');
                    let actionsHtml = '<div style="display: flex; gap: 10px; flex-wrap: wrap;">';
                    
                    if (task.available_actions && task.available_actions.length > 0) {
                        if (task.available_actions.includes('cancel')) {
                            actionsHtml += `
                                <button class="btn btn-danger" onclick="cancelTask(${task.id})">
                                    <i class="fas fa-times"></i>
                                    –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
                                </button>
                            `;
                        }
                        
                        if (task.available_actions.includes('complete')) {
                            actionsHtml += `
                                <button class="btn btn-success" onclick="completeTask(${task.id})">
                                    <i class="fas fa-check"></i>
                                    –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É
                                </button>
                            `;
                        }
                        
                        if (task.available_actions.includes('review') && !task.review) {
                            actionsHtml += `
                                <button class="btn btn-warning" onclick="rateTask(${task.id}, '${task.title}')">
                                    <i class="fas fa-star"></i>
                                    –û—Ü–µ–Ω–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
                                </button>
                            `;
                        }
                    }
                    
                    actionsHtml += '</div>';
                    taskActions.innerHTML = actionsHtml;
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —á–∞—Ç
                    await loadTaskChat();
                    
                } else {
                    showNotification('–ó–∞–¥–∞—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    navigate('tasks');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –∑–∞–¥–∞—á–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á–∏', 'error');
                navigate('tasks');
            } finally {
                hideLoading();
            }
        }
        
        async function loadTaskChat() {
            try {
                const response = await fetch(`/api/tasks/${currentTaskId}/messages`, {
                    headers: {
                        'Authorization': `Bearer ${currentToken}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const taskChat = document.getElementById('taskChat');
                    
                    taskChat.innerHTML = `
                        <div class="chat-container">
                            <div class="chat-header">
                                <div>
                                    <h4 style="margin: 0; color: white;">–ß–∞—Ç –∑–∞–¥–∞—á–∏</h4>
                                    <p style="margin: 5px 0 0; font-size: 0.9rem; opacity: 0.9;">${data.data.messages.length} —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button class="btn btn-secondary" style="padding: 8px 12px; background: rgba(255,255,255,0.2);">
                                        <i class="fas fa-phone"></i>
                                    </button>
                                    <button class="btn btn-secondary" style="padding: 8px 12px; background: rgba(255,255,255,0.2);">
                                        <i class="fas fa-info-circle"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="chat-messages" id="chatMessagesContainer">
                                ${data.data.messages.length > 0 ? data.data.messages.map(msg => `
                                    <div class="chat-message ${msg.user_id === currentUser?.id ? 'own' : ''}">
                                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                                            <div style="width: 30px; height: 30px; background: ${msg.user_id === currentUser?.id ? 'var(--pink-primary)' : 'var(--gray-400)'}; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.8rem; font-weight: 600;">
                                                ${msg.firstName[0]}${msg.lastName[0]}
                                            </div>
                                            <div>
                                                <div style="font-weight: 600; color: var(--gray-900);">
                                                    ${msg.firstName} ${msg.lastName}
                                                    ${msg.role === 'admin' ? ' <span class="badge" style="background: var(--warning); color: white; font-size: 0.7rem; padding: 2px 6px;">–ê–¥–º–∏–Ω</span>' : ''}
                                                    ${msg.role === 'manager' ? ' <span class="badge" style="background: var(--info); color: white; font-size: 0.7rem; padding: 2px 6px;">–ú–µ–Ω–µ–¥–∂–µ—Ä</span>' : ''}
                                                </div>
                                                <div style="font-size: 0.8rem; color: var(--gray-500);">
                                                    ${new Date(msg.created_at).toLocaleString('ru-RU', {hour12: false})}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-message-content">
                                            ${msg.message}
                                        </div>
                                    </div>
                                `).join('') : `
                                    <div style="text-align: center; padding: 40px 20px; color: var(--gray-500);">
                                        <i class="fas fa-comments" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                                        <p>–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                                        <p style="font-size: 0.9rem; margin-top: 10px;">–ù–∞—á–Ω–∏—Ç–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</p>
                                    </div>
                                `}
                            </div>
                            
                            ${data.data.can_send ? `
                                <div class="chat-input">
                                    <input type="text" id="chatMessageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key === 'Enter') sendChatMessage()">
                                    <button class="btn btn-primary" onclick="sendChatMessage()">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            ` : `
                                <div style="padding: 20px; text-align: center; background: white; color: var(--gray-500); border-top: 1px solid var(--gray-200);">
                                    <i class="fas fa-lock"></i> –ß–∞—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∏–ª–∏ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
                                </div>
                            `}
                        </div>
                    `;
                    
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
                    const messagesContainer = document.getElementById('chatMessagesContainer');
                    if (messagesContainer) {
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–∞:', error);
            }
        }
        
        async function sendChatMessage() {
            const input = document.getElementById('chatMessageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            try {
                const response = await fetch(`/api/tasks/${currentTaskId}/messages`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({ message })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    input.value = '';
                    await loadTaskChat();
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è', 'error');
            }
        }
        
        function openTaskChat() {
            const chatInput = document.getElementById('chatMessageInput');
            if (chatInput) {
                chatInput.focus();
            }
        }
        
        // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è
        async function loadProfilePage() {
            if (!currentUser) {
                navigate('home');
                openAuthModal();
                return;
            }
            
            try {
                const response = await fetch('/api/auth/profile', {
                    headers: {
                        'Authorization': `Bearer ${currentToken}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const user = data.data.user;
                    const stats = data.data.stats;
                    
                    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                    const userInfo = document.getElementById('userInfo');
                    userInfo.innerHTML = `
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">–ò–º—è:</strong>
                            <div style="font-size: 1.1rem;">${user.firstName} ${user.lastName}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">Email:</strong>
                            <div style="font-size: 1.1rem;">${user.email}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">–¢–µ–ª–µ—Ñ–æ–Ω:</strong>
                            <div style="font-size: 1.1rem;">${user.phone || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">–†–æ–ª—å:</strong>
                            <div style="font-size: 1.1rem;">${user.role === 'client' ? '–ö–ª–∏–µ–Ω—Ç' : user.role === 'performer' ? '–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å' : user.role}</div>
                        </div>
                        <div>
                            <strong style="color: var(--gray-500);">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong>
                            <div style="font-size: 1.1rem;">${new Date(user.created_at).toLocaleDateString('ru-RU')}</div>
                        </div>
                    `;
                    
                    // –¢–µ–∫—É—â–∞—è –ø–æ–¥–ø–∏—Å–∫–∞
                    const currentSubscription = document.getElementById('currentSubscription');
                    const subscription = data.data.subscription;
                    
                    if (subscription) {
                        const features = subscription.features || [];
                        const usagePercentage = subscription.current_usage ? Math.min(100, subscription.current_usage.percentage) : 0;
                        
                        currentSubscription.innerHTML = `
                            <div style="margin-bottom: 15px;">
                                <strong style="color: var(--gray-500);">–¢–∞—Ä–∏—Ñ:</strong>
                                <div style="font-size: 1.1rem; color: var(--pink-primary); font-weight: 600;">${subscription.display_name}</div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <strong style="color: var(--gray-500);">–°—Ç–∞—Ç—É—Å:</strong>
                                <div>
                                    <span class="badge ${subscription.user_data?.is_active ? 'badge-success' : 'badge-warning'}">
                                        ${subscription.user_data?.is_active ? '–ê–∫—Ç–∏–≤–Ω–∞' : '–ù–µ–∞–∫—Ç–∏–≤–Ω–∞'}
                                    </span>
                                </div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <strong style="color: var(--gray-500);">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á:</strong>
                                <div style="margin-top: 8px;">
                                    <div style="height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                        <div style="width: ${usagePercentage}%; height: 100%; background: var(--pink-gradient);"></div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: var(--gray-500); margin-top: 5px;">
                                        <span>${subscription.current_usage?.tasks_used || 0} –∏–∑ ${subscription.current_usage?.tasks_limit || 0}</span>
                                        <span>${usagePercentage}%</span>
                                    </div>
                                </div>
                            </div>
                            ${subscription.user_data?.expires ? `
                                <div>
                                    <strong style="color: var(--gray-500);">–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ:</strong>
                                    <div style="font-size: 1.1rem;">${new Date(subscription.user_data.expires).toLocaleDateString('ru-RU')}</div>
                                </div>
                            ` : ''}
                        `;
                    }
                    
                    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                    const userStats = document.getElementById('userStats');
                    userStats.innerHTML = `
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">–í—Å–µ–≥–æ –∑–∞–¥–∞—á:</strong>
                            <div style="font-size: 1.1rem;">${stats.total_tasks || 0}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">–í—ã–ø–æ–ª–Ω–µ–Ω–æ:</strong>
                            <div style="font-size: 1.1rem;">${stats.completed_tasks || 0}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gray-500);">–í —Ä–∞–±–æ—Ç–µ:</strong>
                            <div style="font-size: 1.1rem;">${stats.active_tasks || 0}</div>
                        </div>
                        <div>
                            <strong style="color: var(--gray-500);">–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:</strong>
                            <div style="font-size: 1.1rem;">${stats.unread_notifications || 0}</div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è', 'error');
            }
        }
        
        // ==================== API –§–£–ù–ö–¶–ò–ò ====================
        
        async function verifyToken() {
            if (!currentToken) {
                console.log('üîê –¢–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
                currentUser = null;
                updateUserMenu();
                return false;
            }
            
            try {
                const response = await fetch('/api/auth/profile', {
                    headers: {
                        'Authorization': `Bearer ${currentToken}`,
                        'Content-Type': 'application/json'
                    },
                    method: 'GET'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.success) {
                        currentUser = {
                            ...data.data.user,
                            ...data.data.stats
                        };
                        
                        updateUserMenu();
                        return true;
                    }
                }
                
                // –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
                localStorage.removeItem('token');
                currentToken = null;
                currentUser = null;
                updateUserMenu();
                return false;
                
            } catch (error) {
                console.error('üîê –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞:', error);
                return false;
            }
        }
        
        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentUser = data.data.user;
                    currentToken = data.data.token;
                    localStorage.setItem('token', currentToken);
                    
                    showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                    closeModal('authModal');
                    updateUserMenu();
                    
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    navigate(currentPage);
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function register() {
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const firstName = document.getElementById('registerFirstName').value;
            const lastName = document.getElementById('registerLastName').value;
            const phone = document.getElementById('registerPhone').value;
            const role = document.getElementById('registerRole').value;
            
            if (!email || !password || !firstName || !lastName || !phone) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email,
                        password,
                        firstName,
                        lastName,
                        phone,
                        role
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.', 'success');
                    showLoginForm();
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function subscribeToPlan(plan) {
            if (!currentToken) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                openAuthModal();
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch('/api/subscriptions/subscribe', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({
                        plan: plan,
                        period: 'monthly'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞!', 'success');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (data.data.user) {
                        currentUser = data.data.user;
                        updateUserMenu();
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–¥–ø–∏—Å–æ–∫
                        if (currentPage === 'subscriptions') {
                            loadSubscriptionsPage();
                        }
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç
                        if (currentPage === 'profile') {
                            loadProfilePage();
                        }
                    }
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function cancelTask(taskId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')) {
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(`/api/tasks/${taskId}/cancel`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({
                        reason: '–û—Ç–º–µ–Ω–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç–æ–º'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω–µ–Ω–∞', 'success');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    if (currentPage === 'tasks') {
                        loadTasksPage();
                    } else if (currentPage === 'task-details') {
                        loadTaskDetailsPage();
                    }
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã –∑–∞–¥–∞—á–∏', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function completeTask(taskId) {
            if (!confirm('–í—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞?')) {
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(`/api/tasks/${taskId}/status`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({
                        status: 'completed',
                        notes: '–ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–ó–∞–¥–∞—á–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è', 'success');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    if (currentPage === 'tasks') {
                        loadTasksPage();
                    } else if (currentPage === 'task-details') {
                        loadTaskDetailsPage();
                    }
                    
                    // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –æ—Ü–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
                    setTimeout(() => {
                        rateTask(taskId);
                    }, 1500);
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        function rateTask(taskId, taskTitle = '') {
            currentTaskId = taskId;
            document.getElementById('rateTaskTitle').textContent = taskTitle || '–û—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏';
            currentRating = 0;
            updateRatingStars();
            showModal('rateTaskModal');
        }
        
        function setRating(rating) {
            currentRating = rating;
            updateRatingStars();
        }
        
        function updateRatingStars() {
            const stars = document.getElementById('ratingStars');
            const ratingText = document.getElementById('ratingText');
            
            const ratings = [
                '–£–∂–∞—Å–Ω–æ',
                '–ü–ª–æ—Ö–æ',
                '–ù–æ—Ä–º–∞–ª—å–Ω–æ',
                '–•–æ—Ä–æ—à–æ',
                '–û—Ç–ª–∏—á–Ω–æ'
            ];
            
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                starsHtml += `<i class="fas fa-star" onclick="setRating(${i})" style="cursor: pointer; ${i <= currentRating ? 'color: var(--warning); opacity: 1;' : 'opacity: 0.3;'}"></i>`;
            }
            
            stars.innerHTML = starsHtml;
            ratingText.textContent = currentRating > 0 ? ratings[currentRating - 1] : '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–≤–µ–∑–¥—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏';
        }
        
        async function submitRating() {
            if (currentRating === 0) {
                showNotification('–ü–æ—Å—Ç–∞–≤—å—Ç–µ –æ—Ü–µ–Ω–∫—É', 'error');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(`/api/tasks/${currentTaskId}/rate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({
                        rating: currentRating,
                        comment: document.getElementById('ratingComment').value,
                        is_anonymous: document.getElementById('ratingAnonymous').checked
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –æ—Ü–µ–Ω–∫—É!', 'success');
                    closeModal('rateTaskModal');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                    if (currentPage === 'task-details') {
                        loadTaskDetailsPage();
                    }
                } else {
                    showNotification(data.error || '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ü–µ–Ω–∫–∏', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function markAllNotificationsRead() {
            showNotification('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏', 'info');
        }
        
        function logout() {
            localStorage.removeItem('token');
            currentToken = null;
            currentUser = null;
            updateUserMenu();
            navigate('home');
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'info');
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function setupEventListeners() {
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏
            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                }
            });
            
            // Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–æ–∫
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            });
        }
        
        // –î–µ–º–æ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        window.demoLogin = function() {
            document.getElementById('loginEmail').value = 'client1@example.com';
            document.getElementById('loginPassword').value = 'client123';
            login();
        };
        
        console.log('üéÄ –ö–æ–Ω—Å—å–µ—Ä–∂ –°–µ—Ä–≤–∏—Å v5.0.0 –∑–∞–≥—Ä—É–∂–µ–Ω! –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ demoLogin()');
    </script>
</body>
</html>
